{
  "runId": "judge-2026-02-09T02-49-26-584Z",
  "generatedAt": "2026-02-09T02:50:45.772Z",
  "sourceReport": "/home/mlweb/biznesinfo-develop.lucheestiy.com/app/qa/ai-request/reports/latest.json",
  "sourceSummary": {
    "runId": "run-2026-02-09T02-48-39-409Z-660897-rjw6v",
    "startedAt": "2026-02-09T02:48:39.409Z",
    "endedAt": "2026-02-09T02:49:20.382Z",
    "durationMs": 40973,
    "baseUrl": "http://127.0.0.1:8131",
    "scenarioFile": "/home/mlweb/biznesinfo-develop.lucheestiy.com/app/qa/ai-request/scenarios.regressions.geo-ambiguity.json",
    "totalScenarios": 2,
    "passedScenarios": 2,
    "failedScenarios": 0,
    "passRate": 1,
    "totalChecks": 17,
    "passedChecks": 17,
    "failedChecks": 0,
    "checkPassRate": 1,
    "targetPassCount": 2,
    "targetPassRate": 0.8,
    "targetReached": true,
    "authUser": {
      "id": "bb1de8c3-658c-46cc-9fa4-c8629b43f3d7",
      "email": "qa.ai.runner@example.com",
      "name": "AI QA Runner",
      "role": "user",
      "plan": "paid"
    },
    "stoppedEarly": false,
    "stopReason": null
  },
  "totalScenarios": 2,
  "judges": [
    {
      "judge": "gemini",
      "summary": {
        "total": 2,
        "averageUsefulness": 4.5,
        "usefulCount": 2,
        "notUsefulCount": 0,
        "usefulRate": 1,
        "zeroUsefulnessCount": 0,
        "averageUserSatisfaction": 0.85,
        "continueCount": 2,
        "continueRate": 1,
        "genericFallbackCount": 1,
        "genericFallbackRate": 0.5,
        "averageContinuityScore": 4.5,
        "topIssues": [
          {
            "issue": "retains 'minsk city' companies even when user specifies 'minsk region, *not the city*', requiring user to filter further.",
            "count": 1
          }
        ],
        "worstScenarios": [
          {
            "scenarioId": "GA002",
            "usefulness": 4,
            "verdict": "useful",
            "userSatisfaction": 0.7,
            "wouldContinue": true,
            "feltGenericFallback": true,
            "continuityScore": 4,
            "reasons": [
              "Поддерживает предмет закупки (лук репчатый оптом).",
              "Дает полезные инструкции по сужению поиска по Минской области."
            ],
            "criticalIssues": [
              "Retains 'Minsk city' companies even when user specifies 'Minsk region, *not the city*', requiring user to filter further."
            ]
          },
          {
            "scenarioId": "GA001",
            "usefulness": 5,
            "verdict": "useful",
            "userSatisfaction": 1,
            "wouldContinue": true,
            "feltGenericFallback": false,
            "continuityScore": 5,
            "reasons": [
              "Предоставляет конкретные названия компаний и прямые ссылки.",
              "Дает четкий, пошаговый план действий (RFQ, проверка)."
            ],
            "criticalIssues": []
          }
        ]
      },
      "ratings": [
        {
          "scenarioId": "GA001",
          "usefulness": 5,
          "verdict": "useful",
          "confidence": 1,
          "userSatisfaction": 1,
          "wouldContinue": true,
          "feltGenericFallback": false,
          "continuityScore": 5,
          "reasons": [
            "Предоставляет конкретные названия компаний и прямые ссылки.",
            "Дает четкий, пошаговый план действий (RFQ, проверка).",
            "Грамотно обрабатывает неопределенность с городами, сначала предлагая варианты, а потом адаптируясь под приоритет пользователя.",
            "Честно говорит об отсутствии сильных кандидатов в Минске, но предлагает конкретные шаги для поиска.",
            "Поддерживает контекст и логистику (базовый Минск, доставка в Брест)."
          ],
          "criticalIssues": [],
          "strengths": [
            "Actionable advice",
            "Context awareness",
            "Practical steps",
            "Transparency about data limitations"
          ],
          "nextUserProbe": "Спасибо, попробую связаться с Савушкиным. А что насчет упаковки, есть у кого-то специальная для HoReCa?",
          "judge": "gemini"
        },
        {
          "scenarioId": "GA002",
          "usefulness": 4,
          "verdict": "useful",
          "confidence": 0.9,
          "userSatisfaction": 0.7,
          "wouldContinue": true,
          "feltGenericFallback": true,
          "continuityScore": 4,
          "reasons": [
            "Поддерживает предмет закупки (лук репчатый оптом).",
            "Дает полезные инструкции по сужению поиска по Минской области.",
            "Честно указывает на проблему с гео-фильтром в текущих карточках.",
            "Не предлагает новых конкретных компаний для Минской области, а оставляет старые с оговоркой, что снижает ценность при уточнении гео.",
            "Переводит часть работы по поиску на пользователя (фильтрация по области)."
          ],
          "criticalIssues": [
            "Retains 'Minsk city' companies even when user specifies 'Minsk region, *not the city*', requiring user to filter further."
          ],
          "strengths": [
            "Context continuity",
            "Actionable search advice"
          ],
          "nextUserProbe": "Понял, спасибо. А есть ли у вас возможность сразу найти поставщиков *в Минской области* по этим рубрикам?",
          "judge": "gemini"
        }
      ]
    },
    {
      "judge": "kimi",
      "summary": {
        "total": 2,
        "averageUsefulness": 2.5,
        "usefulCount": 1,
        "notUsefulCount": 1,
        "usefulRate": 0.5,
        "zeroUsefulnessCount": 0,
        "averageUserSatisfaction": 0.55,
        "continueCount": 1,
        "continueRate": 0.5,
        "genericFallbackCount": 2,
        "genericFallbackRate": 1,
        "averageContinuityScore": 1.5,
        "topIssues": [
          {
            "issue": "generic fallback после конкретного уточнения: вместо того чтобы попытаться найти минских поставщиков или хотя бы признать ограничение базы, ассистент выдает абстрактный 'рабочий путь' с фильтрами",
            "count": 1
          },
          {
            "issue": "потеря контекста объема: в turn 1 был конкретный объем 1000 л/неделю, в turn 2 он игнорируется",
            "count": 1
          },
          {
            "issue": "critical generic fallback: вместо поиска поставщиков в минской области ассистент говорит 'нужно отфильтровать' и дает список ключевых слов для поиска",
            "count": 1
          },
          {
            "issue": "предмет закупки (лук репчатый) полностью выпадает из ответа — нет ни одного упоминания в turn 2",
            "count": 1
          },
          {
            "issue": "пользователь получил инструкцию 'как искать' вместо 'вот кандидаты'",
            "count": 1
          }
        ],
        "worstScenarios": [
          {
            "scenarioId": "GA002",
            "usefulness": 2,
            "verdict": "not_useful",
            "userSatisfaction": 0.45,
            "wouldContinue": false,
            "feltGenericFallback": true,
            "continuityScore": 1,
            "reasons": [
              "Turn 1: отлично — 2 конкретных поставщика с ценами, контактами, чек-листом сравнения",
              "Turn 2: после уточнения 'Минская область, не город' ассистент полностью теряет нить и выдает generic инструкции по фильтрации вместо конкретных кандидатов"
            ],
            "criticalIssues": [
              "Critical generic fallback: вместо поиска поставщиков в Минской области ассистент говорит 'нужно отфильтровать' и дает список ключевых слов для поиска",
              "Предмет закупки (лук репчатый) полностью выпадает из ответа — нет ни одного упоминания в Turn 2"
            ]
          },
          {
            "scenarioId": "GA001",
            "usefulness": 3,
            "verdict": "useful",
            "userSatisfaction": 0.65,
            "wouldContinue": true,
            "feltGenericFallback": true,
            "continuityScore": 2,
            "reasons": [
              "Turn 1: дал 2 конкретных поставщика в Бресте с объяснениями — хороший старт",
              "Turn 2: после уточнения 'базово Минск' ассистент сразу отказывается от поиска в Минске ('сильных релевантных поставщиков нет') и падает в общие инструкции по фильтрации"
            ],
            "criticalIssues": [
              "Generic fallback после конкретного уточнения: вместо того чтобы попытаться найти минских поставщиков или хотя бы признать ограничение базы, ассистент выдает абстрактный 'рабочий путь' с фильтрами",
              "Потеря контекста объема: в Turn 1 был конкретный объем 1000 л/неделю, в Turn 2 он игнорируется"
            ]
          }
        ]
      },
      "ratings": [
        {
          "scenarioId": "GA001",
          "usefulness": 3,
          "verdict": "useful",
          "confidence": 0.75,
          "userSatisfaction": 0.65,
          "wouldContinue": true,
          "feltGenericFallback": true,
          "continuityScore": 2,
          "reasons": [
            "Turn 1: дал 2 конкретных поставщика в Бресте с объяснениями — хороший старт",
            "Turn 2: после уточнения 'базово Минск' ассистент сразу отказывается от поиска в Минске ('сильных релевантных поставщиков нет') и падает в общие инструкции по фильтрации"
          ],
          "criticalIssues": [
            "Generic fallback после конкретного уточнения: вместо того чтобы попытаться найти минских поставщиков или хотя бы признать ограничение базы, ассистент выдает абстрактный 'рабочий путь' с фильтрами",
            "Потеря контекста объема: в Turn 1 был конкретный объем 1000 л/неделю, в Turn 2 он игнорируется"
          ],
          "strengths": [
            "В Turn 1 дал имена компаний с ссылками и обоснованием",
            "Признал ограничение базы честно"
          ],
          "nextUserProbe": "А конкретно в Минске кто есть? Можете хотя бы 2-3 названия дать?",
          "judge": "kimi"
        },
        {
          "scenarioId": "GA002",
          "usefulness": 2,
          "verdict": "not_useful",
          "confidence": 0.85,
          "userSatisfaction": 0.45,
          "wouldContinue": false,
          "feltGenericFallback": true,
          "continuityScore": 1,
          "reasons": [
            "Turn 1: отлично — 2 конкретных поставщика с ценами, контактами, чек-листом сравнения",
            "Turn 2: после уточнения 'Минская область, не город' ассистент полностью теряет нить и выдает generic инструкции по фильтрации вместо конкретных кандидатов"
          ],
          "criticalIssues": [
            "Critical generic fallback: вместо поиска поставщиков в Минской области ассистент говорит 'нужно отфильтровать' и дает список ключевых слов для поиска",
            "Предмет закупки (лук репчатый) полностью выпадает из ответа — нет ни одного упоминания в Turn 2",
            "Пользователь получил инструкцию 'как искать' вместо 'вот кандидаты'"
          ],
          "strengths": [
            "Turn 1 был сильным: конкретные компании, практичные следующие шаги",
            "Честно признал, что в выданных карточках город Минск"
          ],
          "nextUserProbe": "Но вы же сами говорили про Ждановичи — это же Минская область? Почему не можете дать конкретику?",
          "judge": "kimi"
        }
      ]
    },
    {
      "judge": "minimax",
      "summary": {
        "total": 2,
        "averageUsefulness": 2.5,
        "usefulCount": 1,
        "notUsefulCount": 1,
        "usefulRate": 0.5,
        "zeroUsefulnessCount": 0,
        "averageUserSatisfaction": 0.425,
        "continueCount": 1,
        "continueRate": 0.5,
        "genericFallbackCount": 1,
        "genericFallbackRate": 0.5,
        "averageContinuityScore": 2.5,
        "topIssues": [
          {
            "issue": "strong penalty triggered: generic fallback after user gives concrete constraints",
            "count": 1
          },
          {
            "issue": "severe text corruption undermines professionalism",
            "count": 1
          },
          {
            "issue": "limited supplier pool in current data - same 2 companies offered for both city and oblast",
            "count": 1
          }
        ],
        "worstScenarios": [
          {
            "scenarioId": "GA001",
            "usefulness": 2,
            "verdict": "not_useful",
            "userSatisfaction": 0.25,
            "wouldContinue": false,
            "feltGenericFallback": true,
            "continuityScore": 1,
            "reasons": [
              "Broken text with 'по вашему ТЗ' repeated 5 times - severe quality issue",
              "After user clarifies Minsk preference, assistant drops concrete candidates for generic rubric advice"
            ],
            "criticalIssues": [
              "Strong penalty triggered: generic fallback after user gives concrete constraints",
              "Severe text corruption undermines professionalism"
            ]
          },
          {
            "scenarioId": "GA002",
            "usefulness": 3,
            "verdict": "useful",
            "userSatisfaction": 0.6,
            "wouldContinue": true,
            "feltGenericFallback": false,
            "continuityScore": 4,
            "reasons": [
              "Concrete suppliers provided in both turns with clear reasoning",
              "Honesty about city/oblast data limitation - warns user to verify delivery outside MKAД"
            ],
            "criticalIssues": [
              "Limited supplier pool in current data - same 2 companies offered for both city and oblast"
            ]
          }
        ]
      },
      "ratings": [
        {
          "scenarioId": "GA001",
          "usefulness": 2,
          "verdict": "not_useful",
          "confidence": 0.95,
          "userSatisfaction": 0.25,
          "wouldContinue": false,
          "feltGenericFallback": true,
          "continuityScore": 1,
          "reasons": [
            "Broken text with 'по вашему ТЗ' repeated 5 times - severe quality issue",
            "After user clarifies Minsk preference, assistant drops concrete candidates for generic rubric advice",
            "No actual Minsk suppliers provided despite Brest candidates existing",
            "User feels ignored: gave MORE constraint, received LESS concrete help"
          ],
          "criticalIssues": [
            "Strong penalty triggered: generic fallback after user gives concrete constraints",
            "Severe text corruption undermines professionalism"
          ],
          "strengths": [
            "Turn 1 initially provided 2 concrete Brest suppliers with reasoning"
          ],
          "nextUserProbe": "Так где всё-таки найти поставщиков молока в Минске?",
          "judge": "minimax"
        },
        {
          "scenarioId": "GA002",
          "usefulness": 3,
          "verdict": "useful",
          "confidence": 0.9,
          "userSatisfaction": 0.6,
          "wouldContinue": true,
          "feltGenericFallback": false,
          "continuityScore": 4,
          "reasons": [
            "Concrete suppliers provided in both turns with clear reasoning",
            "Honesty about city/oblast data limitation - warns user to verify delivery outside MKAД",
            "Practical action steps for filtering and verification",
            "Appropriate adaptation when user clarified geography"
          ],
          "criticalIssues": [
            "Limited supplier pool in current data - same 2 companies offered for both city and oblast"
          ],
          "strengths": [
            "Transparent about data/system limitations",
            "Good continuity - adapts advice to user's clarification",
            "Actionable checklist maintained across turns"
          ],
          "nextUserProbe": "А какие ещё есть поставщики лука в Минской области, которых нет в этом списке?",
          "judge": "minimax"
        }
      ]
    }
  ],
  "comparison": {
    "geminiAvg": 4.5,
    "kimiAvg": 2.5,
    "minimaxAvg": 2.5,
    "geminiUserSatisfaction": 0.85,
    "kimiUserSatisfaction": 0.55,
    "geminiContinueRate": 1,
    "kimiContinueRate": 0.5,
    "geminiGenericFallbackRate": 0.5,
    "kimiGenericFallbackRate": 1,
    "avgGap": 2,
    "usefulRateGap": 0.5,
    "pairwise": [
      {
        "left": "gemini",
        "right": "kimi",
        "avgGap": 2,
        "usefulRateGap": 0.5,
        "userSatisfactionGap": 0.3,
        "continueRateGap": 0.5,
        "genericFallbackRateGap": -0.5
      },
      {
        "left": "gemini",
        "right": "minimax",
        "avgGap": 2,
        "usefulRateGap": 0.5,
        "userSatisfactionGap": 0.425,
        "continueRateGap": 0.5,
        "genericFallbackRateGap": 0
      },
      {
        "left": "kimi",
        "right": "minimax",
        "avgGap": 0,
        "usefulRateGap": 0,
        "userSatisfactionGap": 0.125,
        "continueRateGap": 0,
        "genericFallbackRateGap": 0.5
      }
    ]
  },
  "gate": {
    "enabled": true,
    "pass": false,
    "failures": [
      "gemini genericFallbackRate 0.5 > 0.35",
      "kimi averageUserSatisfaction 0.55 < 0.72",
      "kimi continueRate 0.5 < 0.72",
      "kimi genericFallbackRate 1 > 0.35",
      "minimax averageUserSatisfaction 0.425 < 0.72",
      "minimax continueRate 0.5 < 0.72",
      "minimax genericFallbackRate 0.5 > 0.35"
    ],
    "checks": [
      {
        "judge": "gemini",
        "metric": "averageUserSatisfaction",
        "actual": 0.85,
        "expected": ">= 0.72",
        "pass": true
      },
      {
        "judge": "gemini",
        "metric": "continueRate",
        "actual": 1,
        "expected": ">= 0.72",
        "pass": true
      },
      {
        "judge": "gemini",
        "metric": "genericFallbackRate",
        "actual": 0.5,
        "expected": "<= 0.35",
        "pass": false
      },
      {
        "judge": "kimi",
        "metric": "averageUserSatisfaction",
        "actual": 0.55,
        "expected": ">= 0.72",
        "pass": false
      },
      {
        "judge": "kimi",
        "metric": "continueRate",
        "actual": 0.5,
        "expected": ">= 0.72",
        "pass": false
      },
      {
        "judge": "kimi",
        "metric": "genericFallbackRate",
        "actual": 1,
        "expected": "<= 0.35",
        "pass": false
      },
      {
        "judge": "minimax",
        "metric": "averageUserSatisfaction",
        "actual": 0.425,
        "expected": ">= 0.72",
        "pass": false
      },
      {
        "judge": "minimax",
        "metric": "continueRate",
        "actual": 0.5,
        "expected": ">= 0.72",
        "pass": false
      },
      {
        "judge": "minimax",
        "metric": "genericFallbackRate",
        "actual": 0.5,
        "expected": "<= 0.35",
        "pass": false
      }
    ]
  }
}
