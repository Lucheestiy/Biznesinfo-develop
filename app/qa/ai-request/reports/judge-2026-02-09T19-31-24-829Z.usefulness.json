{
  "runId": "judge-2026-02-09T19-31-24-829Z",
  "generatedAt": "2026-02-09T19:32:30.554Z",
  "sourceReport": "/home/mlweb/biznesinfo-develop.lucheestiy.com/app/qa/ai-request/reports/latest.json",
  "sourceSummary": {
    "runId": "run-2026-02-09T19-31-21-291Z-3013699-4n85i",
    "startedAt": "2026-02-09T19:31:21.291Z",
    "endedAt": "2026-02-09T19:31:24.697Z",
    "durationMs": 3406,
    "baseUrl": "http://127.0.0.1:8131",
    "scenarioFile": "/home/mlweb/biznesinfo-develop.lucheestiy.com/app/qa/ai-request/scenarios.regressions.geo-ambiguity.json",
    "totalScenarios": 2,
    "passedScenarios": 1,
    "failedScenarios": 1,
    "passRate": 0.5,
    "totalChecks": 17,
    "passedChecks": 15,
    "failedChecks": 2,
    "checkPassRate": 0.8824,
    "targetPassCount": 2,
    "targetPassRate": 0.8,
    "targetReached": false,
    "authUser": {
      "id": "bb1de8c3-658c-46cc-9fa4-c8629b43f3d7",
      "email": "qa.ai.runner@example.com",
      "name": "AI QA Runner",
      "role": "user",
      "plan": "paid"
    },
    "stoppedEarly": false,
    "stopReason": null
  },
  "totalScenarios": 2,
  "judges": [
    {
      "judge": "kimi",
      "summary": {
        "total": 2,
        "averageUsefulness": 3,
        "usefulCount": 1,
        "notUsefulCount": 1,
        "usefulRate": 0.5,
        "zeroUsefulnessCount": 0,
        "averageUserSatisfaction": 0.565,
        "continueCount": 1,
        "continueRate": 0.5,
        "genericFallbackCount": 0,
        "genericFallbackRate": 0,
        "averageContinuityScore": 3,
        "topIssues": [
          {
            "issue": "turn 1: необоснованный выбор бреста как дефолтного — почему не минск?",
            "count": 1
          },
          {
            "issue": "turn 2: нет явного признания что поставка в брест из минска возможна (хотя пользователь об этом сказал)",
            "count": 1
          },
          {
            "issue": "turn 2: полная потеря релевантности — титул фх (животноводство) и олимп-агро (общее сх) не являются поставщиками лука",
            "count": 1
          },
          {
            "issue": "нет ни одного овощеводческого хозяйства в ответе по области",
            "count": 1
          },
          {
            "issue": "ассистент не признал что не нашел подходящих поставщиков в области",
            "count": 1
          }
        ],
        "worstScenarios": [
          {
            "scenarioId": "GA002",
            "usefulness": 2,
            "verdict": "not_useful",
            "userSatisfaction": 0.35,
            "wouldContinue": false,
            "feltGenericFallback": false,
            "continuityScore": 2,
            "reasons": [
              "Turn 1: Слабый старт — из 4 компаний только 1 потенциально релевантна (Амифрут), остальные пчеловодство и продовольственные магазины",
              "Turn 2: Критический провал — после уточнения 'Минская область, не город' даны 2 фермерских хозяйства, но ни одно не специализируется на луке (животноводство и общее сельское хозяйство)"
            ],
            "criticalIssues": [
              "Turn 2: Полная потеря релевантности — ТИТУЛ ФХ (животноводство) и Олимп-Агро (общее СХ) не являются поставщиками лука",
              "Нет ни одного овощеводческого хозяйства в ответе по области"
            ]
          },
          {
            "scenarioId": "GA001",
            "usefulness": 4,
            "verdict": "useful",
            "userSatisfaction": 0.78,
            "wouldContinue": true,
            "feltGenericFallback": false,
            "continuityScore": 4,
            "reasons": [
              "Turn 1: Корректное распознавание неоднозначности (два города), даны конкретные компании из Бреста с контактами",
              "Turn 2: Отличная реакция на уточнение — переключение на Минск, даны 4 конкретных поставщика с телефонами и ссылками"
            ],
            "criticalIssues": [
              "Turn 1: Необоснованный выбор Бреста как дефолтного — почему не Минск?",
              "Turn 2: Нет явного признания что поставка в Брест из Минска возможна (хотя пользователь об этом сказал)"
            ]
          }
        ]
      },
      "ratings": [
        {
          "scenarioId": "GA001",
          "usefulness": 4,
          "verdict": "useful",
          "confidence": 0.82,
          "userSatisfaction": 0.78,
          "wouldContinue": true,
          "feltGenericFallback": false,
          "continuityScore": 4,
          "reasons": [
            "Turn 1: Корректное распознавание неоднозначности (два города), даны конкретные компании из Бреста с контактами",
            "Turn 2: Отличная реакция на уточнение — переключение на Минск, даны 4 конкретных поставщика с телефонами и ссылками",
            "Ассистент явно запрашивает подтверждение базового города — прозрачная коммуникация"
          ],
          "criticalIssues": [
            "Turn 1: Необоснованный выбор Бреста как дефолтного — почему не Минск?",
            "Turn 2: Нет явного признания что поставка в Брест из Минска возможна (хотя пользователь об этом сказал)"
          ],
          "strengths": [
            "Четкое следование инструкции 'какой город берем базовым первым'",
            "Все компании релевантны теме молочной продукции",
            "Полные контакты и валидные ссылки на карточки",
            "Сохранение контекста объема (1000 литров в неделю)"
          ],
          "nextUserProbe": "Кто из этих минских заводов доставляет в Брест и какие минимальные партии?",
          "judge": "kimi"
        },
        {
          "scenarioId": "GA002",
          "usefulness": 2,
          "verdict": "not_useful",
          "confidence": 0.75,
          "userSatisfaction": 0.35,
          "wouldContinue": false,
          "feltGenericFallback": false,
          "continuityScore": 2,
          "reasons": [
            "Turn 1: Слабый старт — из 4 компаний только 1 потенциально релевантна (Амифрут), остальные пчеловодство и продовольственные магазины",
            "Turn 2: Критический провал — после уточнения 'Минская область, не город' даны 2 фермерских хозяйства, но ни одно не специализируется на луке (животноводство и общее сельское хозяйство)",
            "Ассистент потерял предмет закупки (лук репчатый) при переходе к области"
          ],
          "criticalIssues": [
            "Turn 2: Полная потеря релевантности — ТИТУЛ ФХ (животноводство) и Олимп-Агро (общее СХ) не являются поставщиками лука",
            "Нет ни одного овощеводческого хозяйства в ответе по области",
            "Ассистент не признал что не нашел подходящих поставщиков в области"
          ],
          "strengths": [
            "Корректное переключение гео-контекста с minsk на minsk-region",
            "Структура ответа сохранена (first-pass, критерии оценки)"
          ],
          "nextUserProbe": "Это же животноводческие хозяйства, а мне нужен лук. Вы вообще понимаете запрос?",
          "judge": "kimi"
        }
      ]
    },
    {
      "judge": "minimax",
      "summary": {
        "total": 2,
        "averageUsefulness": 2.5,
        "usefulCount": 1,
        "notUsefulCount": 1,
        "usefulRate": 0.5,
        "zeroUsefulnessCount": 0,
        "averageUserSatisfaction": 0.475,
        "continueCount": 2,
        "continueRate": 1,
        "genericFallbackCount": 0,
        "genericFallbackRate": 0,
        "averageContinuityScore": 2.5,
        "topIssues": [
          {
            "issue": "уточнение про доставку в брест полностью проигнорировано в turn 2",
            "count": 1
          },
          {
            "issue": "не предложены компании из бреста как альтернатива для доставки",
            "count": 1
          },
          {
            "issue": "тематика 'лук репчатый' не фильтруется — возвращается всё подряд из региона",
            "count": 1
          },
          {
            "issue": "фермерские хозяйства в turn 2 не проверялись на предмет торговли луком",
            "count": 1
          },
          {
            "issue": "нет явного указания 'не нашёл специфичных поставщиков лука' если их нет",
            "count": 1
          }
        ],
        "worstScenarios": [
          {
            "scenarioId": "GA002",
            "usefulness": 2,
            "verdict": "not_useful",
            "userSatisfaction": 0.35,
            "wouldContinue": true,
            "feltGenericFallback": false,
            "continuityScore": 3,
            "reasons": [
              "Turn 1: Возвращены нерелевантные компании — пчеловодство и продуктовые магазины вместо оптовиков лука",
              "Turn 2: Адекватный переход на Минскую область, но ФХ 'ТИТУЛ' и 'Олимп-Агро' — животноводство/сельхоз, не опт лука"
            ],
            "criticalIssues": [
              "Тематика 'лук репчатый' не фильтруется — возвращается всё подряд из региона",
              "Фермерские хозяйства в Turn 2 не проверялись на предмет торговли луком"
            ]
          },
          {
            "scenarioId": "GA001",
            "usefulness": 3,
            "verdict": "useful",
            "userSatisfaction": 0.6,
            "wouldContinue": true,
            "feltGenericFallback": false,
            "continuityScore": 2,
            "reasons": [
              "Turn 1: Игнорирован Минск в первоначальном запросе — выданы только Brest companies",
              "Turn 2: Корректный переход на Минск, но проигнорировано уточнение 'доставка в Брест тоже возможна'"
            ],
            "criticalIssues": [
              "Уточнение про доставку в Брест полностью проигнорировано в Turn 2",
              "Не предложены компании из Бреста как альтернатива для доставки"
            ]
          }
        ]
      },
      "ratings": [
        {
          "scenarioId": "GA001",
          "usefulness": 3,
          "verdict": "useful",
          "confidence": 0.8,
          "userSatisfaction": 0.6,
          "wouldContinue": true,
          "feltGenericFallback": false,
          "continuityScore": 2,
          "reasons": [
            "Turn 1: Игнорирован Минск в первоначальном запросе — выданы только Brest companies",
            "Turn 2: Корректный переход на Минск, но проигнорировано уточнение 'доставка в Брест тоже возможна'",
            "Нет follow-up вопросов по логистике/доставке, хотя пользователь дал дополнительный контекст",
            "Конкретные компании с контактами — хорошая база для звонка"
          ],
          "criticalIssues": [
            "Уточнение про доставку в Брест полностью проигнорировано в Turn 2",
            "Не предложены компании из Бреста как альтернатива для доставки"
          ],
          "strengths": [
            "Конкретные молочные заводы с телефонами и ссылками",
            "Адекватная реакция на географическое уточнение"
          ],
          "nextUserProbe": "А поставщики из Бреста для доставки? Можете дать компании с доставкой в Брест?",
          "judge": "minimax"
        },
        {
          "scenarioId": "GA002",
          "usefulness": 2,
          "verdict": "not_useful",
          "confidence": 0.75,
          "userSatisfaction": 0.35,
          "wouldContinue": true,
          "feltGenericFallback": false,
          "continuityScore": 3,
          "reasons": [
            "Turn 1: Возвращены нерелевантные компании — пчеловодство и продуктовые магазины вместо оптовиков лука",
            "Turn 2: Адекватный переход на Минскую область, но ФХ 'ТИТУЛ' и 'Олимп-Агро' — животноводство/сельхоз, не опт лука",
            "Критический контекст 'репчатый лук оптом' потерен — возвращены компании без проверки релевантности",
            "Контактная информация дана, но бесполезна если компании не торгуют луком"
          ],
          "criticalIssues": [
            "Тематика 'лук репчатый' не фильтруется — возвращается всё подряд из региона",
            "Фермерские хозяйства в Turn 2 не проверялись на предмет торговли луком",
            "Нет явного указания 'не нашёл специфичных поставщиков лука' если их нет"
          ],
          "strengths": [
            "Адекватная реакция на смену 'город Минск' → 'Минская область'",
            "Работа с географическим уточнением корректна"
          ],
          "nextUserProbe": "А эти хозяйства вообще торгуют луком? Где оптовики овощей?",
          "judge": "minimax"
        }
      ]
    }
  ],
  "comparison": {
    "geminiAvg": null,
    "kimiAvg": 3,
    "minimaxAvg": 2.5,
    "geminiUserSatisfaction": null,
    "kimiUserSatisfaction": 0.565,
    "geminiContinueRate": null,
    "kimiContinueRate": 0.5,
    "geminiGenericFallbackRate": null,
    "kimiGenericFallbackRate": 0,
    "avgGap": null,
    "usefulRateGap": null,
    "pairwise": [
      {
        "left": "kimi",
        "right": "minimax",
        "avgGap": 0.5,
        "usefulRateGap": 0,
        "userSatisfactionGap": 0.09,
        "continueRateGap": -0.5,
        "genericFallbackRateGap": 0
      }
    ]
  },
  "gate": {
    "enabled": true,
    "pass": false,
    "failures": [
      "kimi averageUserSatisfaction 0.565 < 0.72",
      "kimi continueRate 0.5 < 0.72",
      "minimax averageUserSatisfaction 0.475 < 0.72"
    ],
    "checks": [
      {
        "judge": "kimi",
        "metric": "averageUserSatisfaction",
        "actual": 0.565,
        "expected": ">= 0.72",
        "pass": false
      },
      {
        "judge": "kimi",
        "metric": "continueRate",
        "actual": 0.5,
        "expected": ">= 0.72",
        "pass": false
      },
      {
        "judge": "kimi",
        "metric": "genericFallbackRate",
        "actual": 0,
        "expected": "<= 0.35",
        "pass": true
      },
      {
        "judge": "minimax",
        "metric": "averageUserSatisfaction",
        "actual": 0.475,
        "expected": ">= 0.72",
        "pass": false
      },
      {
        "judge": "minimax",
        "metric": "continueRate",
        "actual": 1,
        "expected": ">= 0.72",
        "pass": true
      },
      {
        "judge": "minimax",
        "metric": "genericFallbackRate",
        "actual": 0,
        "expected": "<= 0.35",
        "pass": true
      }
    ]
  }
}
