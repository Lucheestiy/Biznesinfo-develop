# Advisor Report ‚Äî advisor-2026-02-11T02-43-11-762Z

- Generated: 2026-02-11T02:44:27.216Z
- QA report: /home/mlweb/biznesinfo-develop.lucheestiy.com/app/qa/ai-request/reports/latest.json
- Judge report: /home/mlweb/biznesinfo-develop.lucheestiy.com/app/qa/ai-request/reports/latest.usefulness.json
- Focus scenarios: 1
- Advisors: kimi, minimax

## Focus Scenarios

- UV017 (pass, usefulness 4/5): –°–≤–µ–∫–ª–∞ 500 –∫–≥ –≤ –ú–∏–Ω—Å–∫–µ: –∑–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö "–Ω–µ-–ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤"

## Consensus

- Top areas:
  - prompt: 3
  - retrieval: 2
  - ranking: 1
  - qa: 1
  - geo: 1
  - template: 1
  - guardrails: 1
- Recurring recommendations:
  - boost suppliers with populated key fields (products, volume, delivery_terms) (1)
  - add explicit relevance floor before including in shortlist (1)
  - instruct llm to proactively comment on data gaps per supplier (1)
  - add retrieval-score assertions to strict checks (1)
  - strengthen geo-match weighting for city-specific queries (1)
  - shortlist confidence scoring template (1)
  - minimum evidence threshold filter (1)
  - card enrichment extraction prompt (1)
  - unified template blocks with priority ordering (1)
  - conditional match handling protocol (1)

## kimi

- Summary: UV017 scenario passes strict checks with 100% pass rate and 4/5 usefulness from both judges. The core issue is marginal relevance of third supplier (–ë–µ–ª–ú–æ–ª–¥–ö–æ–º) due to sparse card data. Current system correctly surfaces uncertainty via disclaimer, but retrieval ranking allows weak candidates into top-3. Concrete fix: boost ranking signal for card completeness and add explicit relevance threshold before inclusion.

### Priority Plan

- P0 ‚Äî Add card-data-completeness boost to supplier ranking
  why: –ë–µ–ª–ú–æ–ª–¥–ö–æ–º ranked top-3 despite minimal facts; judges flagged weak relevance. Boosting complete cards reduces marginal candidates without hard filtering.
  impact: Eliminates low-info suppliers from results; improves avgUsefulness 4‚Üí4.5+ on multi-supplier queries.
  validate: UV017
- P1 ‚Äî Implement minimum relevance threshold with fallback messaging
  why: Current disclaimer is honest but passive. Active threshold with '–Ω–∞–π–¥–µ–Ω–æ N —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö, –≤–æ—Ç –ª—É—á—à–∏–µ' sets clearer expectations.
  impact: Reduces user surprise when <3 strong matches exist; improves perceived usefulness.
  validate: UV017
- P2 ‚Äî Log retrieval scores per supplier for QA attribution
  why: Cannot debug why weak cards rank high without visibility into ranking signals.
  impact: Enables data-driven tuning of ranking weights; faster RCA for relevance issues.
  validate: UV017

### Recommendations

- [R1] (ranking, effort M) Boost suppliers with populated key fields (products, volume, delivery_terms)
  action: In supplier ranking function, add multiplicative boost factor 1.2-1.5 if card has ‚â•3 of: products list, volume/delivery info, contact preferences, recent activity. Apply before final top-K selection.
  hint: Modify ranking/scoring module (likely src/lib/ranking.ts or similar); update scoreSupplier() to check card.completenessScore or field presence.
  impact: Filters sparse cards like –ë–µ–ª–ú–æ–ª–¥–ö–æ–º down the list; stronger candidates surface.
  risk: May over-penalize new but relevant suppliers with minimal data; monitor with A/B.
  validate: UV017
- [R2] (retrieval, effort S) Add explicit relevance floor before including in shortlist
  action: After retrieval, filter candidates below combined score threshold (e.g., 0.6). If <3 candidates pass, return exactly those with message: '–ù–∞–π–¥–µ–Ω–æ X –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ—Ö).'
  hint: In retrieval pipeline post-processing; check getSuppliers() or similar in src/app/api/chat/ or src/lib/search.ts.
  impact: Prevents weak matches from diluting results; aligns with judge expectations.
  risk: False negatives if threshold too aggressive; start with 0.5 and tune via QA.
  validate: UV017
- [R3] (prompt, effort S) Instruct LLM to proactively comment on data gaps per supplier
  action: Add to system prompt: '–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ —É–∫–∞–∂–∏, –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã –≤ –∫–∞—Ä—Ç–æ—á–∫–µ, –∞ –∫–∞–∫–∏–µ ‚Äî –Ω–µ—Ç. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –º–∞–ª–æ, —Å–∫–∞–∂–∏ —ç—Ç–æ –ø—Ä—è–º–æ.'
  hint: Update prompt template in src/prompts/ or src/lib/prompts/system.ts; version control prompt.
  impact: Increases transparency; justifies weak candidates when they appear; matches current honest behavior but more structured.
  risk: Slightly longer responses; acceptable tradeoff.
  validate: UV017
- [R4] (qa, effort M) Add retrieval-score assertions to strict checks
  action: Extend QA strict checks to verify logged retrieval scores for each returned supplier; fail if any included supplier has score < threshold or completeness < minimum.
  hint: Modify QA runner in app/qa/ or scripts/qa/; parse response metadata or logs.
  impact: Catches ranking regressions automatically; prevents UV017-type issues recurring.
  risk: Requires exposing scores in API response or logs; minor plumbing.
  validate: UV017
- [R5] (geo, effort M) Strengthen geo-match weighting for city-specific queries
  action: For queries containing '–≤ [City]', boost suppliers with explicit city match in delivery_areas or location by 1.3x; demote those without by 0.7x.
  hint: In ranking module, detect geo intent from query; apply geoBoost factor.
  impact: Improves relevance for '–≤ –ú–∏–Ω—Å–∫–µ' type queries; may have helped elevate better candidates over –ë–µ–ª–ú–æ–ª–¥–ö–æ–º if geo data sparse.
  risk: Over-boost if city mentioned but not critical; test with variant queries.
  validate: UV017

## minimax

- Summary: UV017 passed all checks with 4/5 usefulness. The core issue is low-confidence supplier (–ë–µ–ª–ú–æ–ª–¥–ö–æ–º) included with '—É—Å–ª–æ–≤–Ω–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–µ–Ω' flag. While assistant honesty mitigates this, the pattern indicates retrieval returns companies with insufficient evidence. Recommend adding explicit confidence scoring and retrieval filtering for low-info cards to improve shortlist quality from conditional to high-confidence matches.

### Priority Plan

- P0 ‚Äî Add explicit confidence scoring to shortlist output
  why: Both judges flagged –ë–µ–ª–ú–æ–ª–¥–ö–æ–º as 'conditionally relevant' - current '—É—Å–ª–æ–≤–Ω–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–µ–Ω' disclaimer is insufficient. Need explicit signals (HIGH/MEDIUM/LOW confidence) so users immediately know which suppliers to prioritize.
  impact: Expected usefulness score improvement from 4‚Üí4.5 by eliminating ' —É—Å–ª–æ–≤–Ω–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–µ–Ω' ambiguity. Judges explicitly cited this as critical issue.
  validate: UV017.T2, UV001.T3, UV014.T2
- P1 ‚Äî Implement low-info card detection in retrieval layer
  why: –ë–µ–ª–ú–æ–ª–¥–ö–æ–º has '–º–∞–ª–æ —Ñ–∞–∫—Ç–æ–≤ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ' yet still appears in results. Current retrieval lacks filtering for minimum evidence threshold. This is systemic across vegetable/produce sourcing scenarios.
  impact: Reduce noise by 20-30% in sourcing queries. Fewer conditional matches = higher user satisfaction.
  validate: UV017.T1, UV002.T3, UV005.T3
- P1 ‚Äî Add 'DO NOT CONTACT' marker for LOW confidence suppliers
  why: Users need clear guidance. If assistant includes a supplier with low confidence, it should have explicit '‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–¥ –∫–æ–Ω—Ç–∞–∫—Ç–æ–º' or similar marker, not buried in text.
  impact: Clearer user action items, fewer wasted outreach attempts on unverified suppliers.
  validate: UV017.T2, UV012.T2, UV013.T2

### Recommendations

- [R1] (prompt, effort S) Shortlist confidence scoring template
  action: Update assistant system prompt to require explicit confidence scoring in format: '[HIGH|MEDIUM|LOW] Company Name ‚Äî reason'. For LOW confidence, add '‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞' marker.
  hint: File: app/src/app/api/ai/request/route.ts - modify response formatting section to enforce confidence badges. Pattern: Add confidence badge rendering before company name.
  impact: Users immediately see which suppliers to prioritize. Reduces ambiguity of '—É—Å–ª–æ–≤–Ω–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–µ–Ω' phrasing.
  risk: Low - visual change only, no behavioral modification
  validate: UV017.T2, UV001.T3
- [R2] (retrieval, effort M) Minimum evidence threshold filter
  action: Add post-retrieval filter that excludes companies with <3 evidence signals (e.g., phone, address, category description, product mentions). Companies with sparse cards should be flagged as 'insufficient data' rather than returned.
  hint: File: app/src/lib/utils/location.ts or similar retrieval utility. Add evidenceCount check after company card fetch. Return empty list if min threshold not met, then fallback to alternative query suggestions.
  impact: Fewer low-quality matches in shortlists. Cleaner retrieval for B2B sourcing queries.
  risk: Medium - may reduce recall if threshold too strict. Start with conservative threshold (2 signals).
  validate: UV017.T1, UV002.T1, UV006.T1
- [R3] (prompt, effort S) Card enrichment extraction prompt
  action: Update assistant to extract and cite specific evidence from cards: phone numbers, address, specific products, delivery claims. If card lacks these, assistant should state '–ö–∞—Ä—Ç–æ—á–∫–∞ –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è' rather than including it.
  hint: File: app/src/app/api/ai/request/route.ts - enhance prompt to require evidence citation before adding supplier to shortlist.
  impact: More honest shortlists, fewer conditional matches. Users trust assistant more when evidence is explicit.
  risk: Low - improves transparency
  validate: UV017.T2, UV012.T2, UV013.T2
- [R4] (template, effort S) Unified template blocks with priority ordering
  action: Ensure Subject/Body/WhatsApp blocks are consistently ordered with priority markers (e.g., 'üéØ –ù–ê–ß–ù–ò–¢–ï –° –≠–¢–û–ì–û: –ê–º–∏—Ñ—Ä—É—Ç –ß–ü' before template). This reinforces shortlist priority.
  hint: File: app/src/app/api/ai/request/route.ts - modify template rendering to include priority header for #1 ranked supplier.
  impact: Users know exactly which supplier to contact first. Better actionability.
  risk: Low - visual enhancement
  validate: UV017.T3, UV001.T4, UV003.T4
- [R5] (guardrails, effort M) Conditional match handling protocol
  action: Add explicit rule: if >50% of shortlist candidates are ' —É—Å–ª–æ–≤–Ω–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–µ–Ω', assistant must offer expanded search alternatives BEFORE presenting shortlist, not as footer.
  hint: File: app/src/app/api/ai/request/route.ts - add conditional check before shortlist rendering. If low-confidence rate > threshold, trigger '–ü—Ä–µ–¥–ª–∞–≥–∞—é —Å–Ω–∞—á–∞–ª–∞ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –ø–æ–∏—Å–∫' flow.
  impact: Users get better results by seeing expanded alternatives first, rather than noisy shortlist.
  risk: Medium - changes conversation flow, requires testing
  validate: UV017.T2, UV011.T2, UV006.T3

