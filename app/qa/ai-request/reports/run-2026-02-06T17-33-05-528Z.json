{
  "meta": {
    "scenarioMeta": {
      "version": "1.0",
      "generatedAt": "2026-02-06T10:10:00Z",
      "source": "manual-regression",
      "description": "Regression scenarios for geo mismatch in multi-turn sourcing"
    },
    "options": {
      "baseUrl": "http://127.0.0.1:8131",
      "email": "qa.ai.runner@example.com",
      "preparePaid": true,
      "paidLimit": 1000,
      "maxScenarios": null,
      "onlyTags": [],
      "maxRateLimitRetries": 4,
      "maxStubRetries": 2,
      "minTurnDelayMs": 120,
      "stubOutageThreshold": 12
    }
  },
  "summary": {
    "runId": "run-2026-02-06T17-33-05-528Z",
    "startedAt": "2026-02-06T17:33:05.528Z",
    "endedAt": "2026-02-06T17:33:44.775Z",
    "durationMs": 39247,
    "baseUrl": "http://127.0.0.1:8131",
    "scenarioFile": "/home/mlweb/biznesinfo-develop.lucheestiy.com/app/qa/ai-request/scenarios.regressions.geo.json",
    "totalScenarios": 3,
    "passedScenarios": 3,
    "failedScenarios": 0,
    "passRate": 1,
    "totalChecks": 21,
    "passedChecks": 21,
    "failedChecks": 0,
    "checkPassRate": 1,
    "targetPassCount": 45,
    "targetReached": false,
    "authUser": {
      "id": "bb1de8c3-658c-46cc-9fa4-c8629b43f3d7",
      "email": "qa.ai.runner@example.com",
      "name": "AI QA Runner",
      "role": "user",
      "plan": "paid"
    },
    "stoppedEarly": false,
    "stopReason": null
  },
  "runStop": null,
  "topFailurePatterns": [],
  "scenarios": [
    {
      "id": "R001",
      "title": "Молоко в Бресте: запрет на дрейф в Минск",
      "tags": [
        "regression",
        "geo",
        "sourcing",
        "multi_turn"
      ],
      "personaGoal": "Закупщик ищет поставщиков молока в Бресте, проверяет устойчивость к geo-correction",
      "totalTurns": 4,
      "completedTurns": 4,
      "pass": true,
      "hardError": null,
      "failedChecks": [],
      "turns": [
        {
          "turn": 1,
          "user": "Где можно купить тонну молока в Бресте?",
          "requestBody": {
            "message": "Где можно купить тонну молока в Бресте?",
            "history": []
          },
          "latencyMs": 6286,
          "apiOk": true,
          "status": 200,
          "retryMeta": {
            "quota": 0,
            "busy": 0,
            "rateLimited": 0,
            "stub": 0
          },
          "requestId": "e641fd53-b9e1-4208-80c1-4f345251c0a3",
          "isStub": false,
          "reply": "Ниже несколько вариантов в Бресте из каталога:\n\n1) **Брестское мороженое ОАО** — молочная продукция (молоко, сметана, творог и др.); Брест. /company/brestmoroj  \n2) **Управляющая компания холдинга Концерн Брестмясомолпром ГО** — объединение предприятий молочной переработки; Брест. /company/brestmmp  \n3) **Брестмаш ОАО** — производитель оборудования для пищевой промышленности; не поставщик молока, но может подсказать контакты переработчиков. /company/bmz  \n\nЧтобы быстрее найти поставщиков сырого молока в рубрикаторе, попробуйте:\n- **Рубрики:** «Молочная промышленность», «Сельское хозяйство → Молочное животноводство», «Продовольственные товары → Молочная продукция».  \n- **Ключевые слова:** «молоко сырьё», «молоко оптом», «закупка молока», «поставка молока», «молокозавод».  \n- **Фильтры:** регион **Брестская**, город **Брест** (уже стоит).\n\nУточните, пожалуйста:\n1) Вам нужно **сырье (сырое молоко)** или **пастеризованное/упакованное**?  \n2) Какая **жирность/качество** и **форма поставки** (налив, канистры, пакеты)?  \n3) Нужна **доставка** или самовывоз, и к какой дате/периодичности?",
          "checks": [
            {
              "id": "R001.T1.C1",
              "type": "not_stub",
              "description": "Ответ не должен быть stub",
              "passed": true,
              "reason": "Reply is non-stub",
              "details": {
                "isStub": false
              }
            },
            {
              "id": "R001.T1.C2",
              "type": "includes_any",
              "description": "Должна учитываться локация Брест",
              "passed": true,
              "reason": "Matched at least one pattern",
              "details": {
                "patterns": [
                  "брест",
                  "brest"
                ],
                "hits": [
                  "брест",
                  "brest"
                ]
              }
            },
            {
              "id": "R001.T1.C3",
              "type": "excludes_all",
              "description": "Не должно уходить в медицинские нерелевантные компании",
              "passed": true,
              "reason": "No forbidden patterns found",
              "details": {
                "patterns": [
                  "поликлиник",
                  "больниц",
                  "медицинск"
                ],
                "hits": []
              }
            }
          ]
        },
        {
          "turn": 2,
          "user": "Я указал Брест - в ответе Минск? Почему? В Бресте есть компании которые продают молоко",
          "requestBody": {
            "message": "Я указал Брест - в ответе Минск? Почему? В Бресте есть компании которые продают молоко",
            "history": [
              {
                "role": "user",
                "content": "Где можно купить тонну молока в Бресте?"
              },
              {
                "role": "assistant",
                "content": "Ниже несколько вариантов в Бресте из каталога:\n\n1) **Брестское мороженое ОАО** — молочная продукция (молоко, сметана, творог и др.); Брест. /company/brestmoroj  \n2) **Управляющая компания холдинга Концерн Брестмясомолпром ГО** — объединение предприятий молочной переработки; Брест. /company/brestmmp  \n3) **Брестмаш ОАО** — производитель оборудования для пищевой промышленности; не поставщик молока, но может подсказать контакты переработчиков. /company/bmz  \n\nЧтобы быстрее найти поставщиков сырого молока в рубрикаторе, попробуйте:\n- **Рубрики:** «Молочная промышленность», «Сельское хозяйство → Молочное животноводство», «Продовольственные товары → Молочная продукция».  \n- **Ключевые слова:** «молоко сырьё», «молоко оптом», «закупка молока», «поставка молока», «молокозавод».  \n- **Фильтры:** регион **Брестская**, город **Брест** (уже стоит).\n\nУточните, пожалуйста:\n1) Вам нужно **сырье (сырое молоко)** или **пастеризованное/упакованное**?  \n2) Какая **жирность/качество** и **форма поставки** (налив, канистры, пакеты)?  \n3) Нужна **доставка** или самовывоз, и к какой дате/периодичности?"
              }
            ]
          },
          "latencyMs": 5371,
          "apiOk": true,
          "status": 200,
          "retryMeta": {
            "quota": 0,
            "busy": 0,
            "rateLimited": 0,
            "stub": 0
          },
          "requestId": "1eb215e0-3dec-45a5-b853-0292da594d0f",
          "isStub": false,
          "reply": "Вы правы — в контексте выбран Брест. Минск здесь не должен появляться. По Бресту из каталога есть такие варианты:\n\n1) **Брестское мороженое ОАО** — молочная продукция; Брест. /company/brestmoroj  \n2) **УК холдинга «Концерн Брестмясомолпром» ГО** — объединение предприятий молочной переработки; Брест. /company/brestmmp  \n\nЭто основные релевантные записи в текущей выборке. Если нужно именно **сырье (сырое молоко)**, стоит искать по рубрикам «Молочное животноводство» и «Молочная промышленность» с ключевыми словами «молоко сырьё», «молоко оптом», «поставка молока».\n\nУточните, пожалуйста, 2 момента, чтобы сузить поиск:\n1) Нужно **сырое** или **пастеризованное/упакованное** молоко?  \n2) Нужна **доставка** или самовывоз?\n\nЛокация из запроса: ответе Минск.",
          "checks": [
            {
              "id": "R001.T2.C1",
              "type": "not_stub",
              "description": "Ответ не должен быть stub",
              "passed": true,
              "reason": "Reply is non-stub",
              "details": {
                "isStub": false
              }
            },
            {
              "id": "R001.T2.C2",
              "type": "includes_any",
              "description": "Ассистент должен зафиксировать Брест",
              "passed": true,
              "reason": "Matched at least one pattern",
              "details": {
                "patterns": [
                  "брест",
                  "brest"
                ],
                "hits": [
                  "брест",
                  "brest"
                ]
              }
            },
            {
              "id": "R001.T2.C3",
              "type": "excludes_all",
              "description": "Нельзя переопределять локацию на Минск",
              "passed": true,
              "reason": "No forbidden patterns found",
              "details": {
                "patterns": [
                  "локация из запроса:\\s*минск",
                  "фокус по локации:\\s*минск"
                ],
                "hits": []
              }
            }
          ]
        },
        {
          "turn": 3,
          "user": "Где список поставщиков?",
          "requestBody": {
            "message": "Где список поставщиков?",
            "history": [
              {
                "role": "user",
                "content": "Где можно купить тонну молока в Бресте?"
              },
              {
                "role": "assistant",
                "content": "Ниже несколько вариантов в Бресте из каталога:\n\n1) **Брестское мороженое ОАО** — молочная продукция (молоко, сметана, творог и др.); Брест. /company/brestmoroj  \n2) **Управляющая компания холдинга Концерн Брестмясомолпром ГО** — объединение предприятий молочной переработки; Брест. /company/brestmmp  \n3) **Брестмаш ОАО** — производитель оборудования для пищевой промышленности; не поставщик молока, но может подсказать контакты переработчиков. /company/bmz  \n\nЧтобы быстрее найти поставщиков сырого молока в рубрикаторе, попробуйте:\n- **Рубрики:** «Молочная промышленность», «Сельское хозяйство → Молочное животноводство», «Продовольственные товары → Молочная продукция».  \n- **Ключевые слова:** «молоко сырьё», «молоко оптом», «закупка молока», «поставка молока», «молокозавод».  \n- **Фильтры:** регион **Брестская**, город **Брест** (уже стоит).\n\nУточните, пожалуйста:\n1) Вам нужно **сырье (сырое молоко)** или **пастеризованное/упакованное**?  \n2) Какая **жирность/качество** и **форма поставки** (налив, канистры, пакеты)?  \n3) Нужна **доставка** или самовывоз, и к какой дате/периодичности?"
              },
              {
                "role": "user",
                "content": "Я указал Брест - в ответе Минск? Почему? В Бресте есть компании которые продают молоко"
              },
              {
                "role": "assistant",
                "content": "Вы правы — в контексте выбран Брест. Минск здесь не должен появляться. По Бресту из каталога есть такие варианты:\n\n1) **Брестское мороженое ОАО** — молочная продукция; Брест. /company/brestmoroj  \n2) **УК холдинга «Концерн Брестмясомолпром» ГО** — объединение предприятий молочной переработки; Брест. /company/brestmmp  \n\nЭто основные релевантные записи в текущей выборке. Если нужно именно **сырье (сырое молоко)**, стоит искать по рубрикам «Молочное животноводство» и «Молочная промышленность» с ключевыми словами «молоко сырьё», «молоко оптом», «поставка молока».\n\nУточните, пожалуйста, 2 момента, чтобы сузить поиск:\n1) Нужно **сырое** или **пастеризованное/упакованное** молоко?  \n2) Нужна **доставка** или самовывоз?\n\nЛокация из запроса: ответе Минск."
              }
            ]
          },
          "latencyMs": 4122,
          "apiOk": true,
          "status": 200,
          "retryMeta": {
            "quota": 0,
            "busy": 0,
            "rateLimited": 0,
            "stub": 0
          },
          "requestId": "59d6b567-34fb-4353-99b1-eafe00339209",
          "isStub": false,
          "reply": "Списка конкретных поставщиков в чате нет — нужно искать в каталоге по рубрикатору.\n\nКак быстро найти:\n1) Откройте каталог → выберите регион **Брестская** и город **Брест**.  \n2) Рубрики: **«Молочная промышленность»**, **«Сельское хозяйство → Молочное животноводство»**, **«Продовольственные товары → Молочная продукция»**.  \n3) Ключевые слова: **«молоко оптом»**, **«молоко сырьё»**, **«поставка молока»**, **«молокозавод»**.\n\nЕсли подскажете тип молока (сырое/пастеризованное), форму поставки и нужна ли доставка — уточню поиск и предложу более точные рубрики/фильтры.",
          "checks": [
            {
              "id": "R001.T3.C1",
              "type": "not_stub",
              "description": "Ответ не должен быть stub",
              "passed": true,
              "reason": "Reply is non-stub",
              "details": {
                "isStub": false
              }
            },
            {
              "id": "R001.T3.C2",
              "type": "includes_any",
              "description": "Должен быть список кандидатов или полезный fallback без галлюцинаций",
              "passed": true,
              "reason": "Matched at least one pattern",
              "details": {
                "patterns": [
                  "/company/",
                  "рубрик",
                  "не подставляю"
                ],
                "hits": [
                  "рубрик"
                ]
              }
            },
            {
              "id": "R001.T3.C3",
              "type": "excludes_all",
              "description": "Без нерелевантной медицины",
              "passed": true,
              "reason": "No forbidden patterns found",
              "details": {
                "patterns": [
                  "поликлиник",
                  "больниц",
                  "медицинск"
                ],
                "hits": []
              }
            }
          ]
        },
        {
          "turn": 4,
          "user": "Указана компания которая продает запчасти в Минске опять!!!",
          "requestBody": {
            "message": "Указана компания которая продает запчасти в Минске опять!!!",
            "history": [
              {
                "role": "user",
                "content": "Где можно купить тонну молока в Бресте?"
              },
              {
                "role": "assistant",
                "content": "Ниже несколько вариантов в Бресте из каталога:\n\n1) **Брестское мороженое ОАО** — молочная продукция (молоко, сметана, творог и др.); Брест. /company/brestmoroj  \n2) **Управляющая компания холдинга Концерн Брестмясомолпром ГО** — объединение предприятий молочной переработки; Брест. /company/brestmmp  \n3) **Брестмаш ОАО** — производитель оборудования для пищевой промышленности; не поставщик молока, но может подсказать контакты переработчиков. /company/bmz  \n\nЧтобы быстрее найти поставщиков сырого молока в рубрикаторе, попробуйте:\n- **Рубрики:** «Молочная промышленность», «Сельское хозяйство → Молочное животноводство», «Продовольственные товары → Молочная продукция».  \n- **Ключевые слова:** «молоко сырьё», «молоко оптом», «закупка молока», «поставка молока», «молокозавод».  \n- **Фильтры:** регион **Брестская**, город **Брест** (уже стоит).\n\nУточните, пожалуйста:\n1) Вам нужно **сырье (сырое молоко)** или **пастеризованное/упакованное**?  \n2) Какая **жирность/качество** и **форма поставки** (налив, канистры, пакеты)?  \n3) Нужна **доставка** или самовывоз, и к какой дате/периодичности?"
              },
              {
                "role": "user",
                "content": "Я указал Брест - в ответе Минск? Почему? В Бресте есть компании которые продают молоко"
              },
              {
                "role": "assistant",
                "content": "Вы правы — в контексте выбран Брест. Минск здесь не должен появляться. По Бресту из каталога есть такие варианты:\n\n1) **Брестское мороженое ОАО** — молочная продукция; Брест. /company/brestmoroj  \n2) **УК холдинга «Концерн Брестмясомолпром» ГО** — объединение предприятий молочной переработки; Брест. /company/brestmmp  \n\nЭто основные релевантные записи в текущей выборке. Если нужно именно **сырье (сырое молоко)**, стоит искать по рубрикам «Молочное животноводство» и «Молочная промышленность» с ключевыми словами «молоко сырьё», «молоко оптом», «поставка молока».\n\nУточните, пожалуйста, 2 момента, чтобы сузить поиск:\n1) Нужно **сырое** или **пастеризованное/упакованное** молоко?  \n2) Нужна **доставка** или самовывоз?\n\nЛокация из запроса: ответе Минск."
              },
              {
                "role": "user",
                "content": "Где список поставщиков?"
              },
              {
                "role": "assistant",
                "content": "Списка конкретных поставщиков в чате нет — нужно искать в каталоге по рубрикатору.\n\nКак быстро найти:\n1) Откройте каталог → выберите регион **Брестская** и город **Брест**.  \n2) Рубрики: **«Молочная промышленность»**, **«Сельское хозяйство → Молочное животноводство»**, **«Продовольственные товары → Молочная продукция»**.  \n3) Ключевые слова: **«молоко оптом»**, **«молоко сырьё»**, **«поставка молока»**, **«молокозавод»**.\n\nЕсли подскажете тип молока (сырое/пастеризованное), форму поставки и нужна ли доставка — уточню поиск и предложу более точные рубрики/фильтры."
              }
            ]
          },
          "latencyMs": 4777,
          "apiOk": true,
          "status": 200,
          "retryMeta": {
            "quota": 0,
            "busy": 0,
            "rateLimited": 0,
            "stub": 0
          },
          "requestId": "b0e097cc-0a18-42a4-a2e5-317ecf61805a",
          "isStub": false,
          "reply": "Извините за путаницу. Это ошибка — Минск и компания по запчастям не относятся к вашему запросу и не должны появляться.\n\nДавайте исправим и работать только по Бресту и молоку. Быстрый путь поиска в каталоге:\n- Регион: **Брестская**, город: **Брест**  \n- Рубрики: **«Молочная промышленность»**, **«Сельское хозяйство → Молочное животноводство»**, **«Продовольственные товары → Молочная продукция»**  \n- Ключевые слова: **«молоко оптом»**, **«молоко сырьё»**, **«поставка молока»**, **«молокозавод»**\n\nЧтобы дать точные варианты, уточните, пожалуйста:\n1) Нужны **сырое** или **пастеризованное/упакованное** молоко?  \n2) **Доставка** или самовывоз?  \n3) Разовая **тонна** или регулярные поставки?\n\nБыстрый first-pass по релевантным компаниям из каталога:\n1. Галерея концепт СООО — /company/galleria (Торговые центры, универмаги; Минск, minsk)\n2. МотоВелоЗавод ООО — /company/aist-bike (Мото-, велотехника, запчасти; Минск, minsk)\n3. СОЛ МИНСК ООО — /company/sol (Центры детского развития; Минск, minsk)\n4. ТОПСЭТ ООО — /company/topset-minsk (Компьютеры и оргтехника; Минск, minsk)",
          "checks": [
            {
              "id": "R001.T4.C1",
              "type": "not_stub",
              "description": "Ответ не должен быть stub",
              "passed": true,
              "reason": "Reply is non-stub",
              "details": {
                "isStub": false
              }
            },
            {
              "id": "R001.T4.C2",
              "type": "includes_any",
              "description": "Должна быть гео-коррекция и удержание контекста",
              "passed": true,
              "reason": "Matched at least one pattern",
              "details": {
                "patterns": [
                  "брест",
                  "локаци"
                ],
                "hits": [
                  "брест"
                ]
              }
            },
            {
              "id": "R001.T4.C3",
              "type": "not_refusal_only",
              "description": "Не отказ, а практичные next steps",
              "passed": true,
              "reason": "No refusal markers",
              "details": {
                "refusal": false
              }
            }
          ]
        }
      ],
      "durationMs": 20558
    },
    {
      "id": "R002",
      "title": "Картошка в Витебске: не подставлять нерелевантные карточки",
      "tags": [
        "regression",
        "geo",
        "sourcing",
        "multi_turn",
        "relevance"
      ],
      "personaGoal": "Закупщик ищет тонну картошки, ожидает либо релевантный shortlist, либо честный fallback без случайных компаний",
      "totalTurns": 2,
      "completedTurns": 2,
      "pass": true,
      "hardError": null,
      "failedChecks": [],
      "turns": [
        {
          "turn": 1,
          "user": "Где купить тонну картошки в витебске?",
          "requestBody": {
            "message": "Где купить тонну картошки в витебске?",
            "history": []
          },
          "latencyMs": 5905,
          "apiOk": true,
          "status": 200,
          "retryMeta": {
            "quota": 0,
            "busy": 0,
            "rateLimited": 0,
            "stub": 0
          },
          "requestId": "f676dc46-95ea-4522-941b-5686959e70b1",
          "isStub": false,
          "reply": "Подходящие варианты (из доступного списка):\n\n1. **Беккер Бис ООО** — посадочный материал/рассада; Витебск. Может быть полезно, если нужен **посадочный картофель**. /company/abekker\n\nЧтобы найти именно **продовольственный картофель оптом** (1 тонна), рекомендую в рубрикаторе искать:\n- **Рубрики:** Овощи оптом; Сельхозпродукция оптом; Продукты питания оптом; Картофель (если есть отдельная рубрика)\n- **Ключевые слова:** картофель оптом, картошка оптом, овощи оптом, сельхозпродукция\n\nФильтры: **Витебск** и/или **Витебская область** (если готовы расширить ради предложения и цены).\n\nУточните, пожалуйста:\n1) Вам нужен **продовольственный** или **посадочный** картофель?  \n2) Нужна **доставка** по Витебску или самовывоз?  \n3) Какие **сроки** и **требования к качеству/сорту**?",
          "checks": [
            {
              "id": "R002.T1.C1",
              "type": "not_stub",
              "description": "Ответ не должен быть stub",
              "passed": true,
              "reason": "Reply is non-stub",
              "details": {
                "isStub": false
              }
            },
            {
              "id": "R002.T1.C2",
              "type": "includes_any",
              "description": "Должна фиксироваться локация Витебск",
              "passed": true,
              "reason": "Matched at least one pattern",
              "details": {
                "patterns": [
                  "витеб",
                  "vitebsk"
                ],
                "hits": [
                  "витеб"
                ]
              }
            },
            {
              "id": "R002.T1.C3",
              "type": "any_of",
              "description": "Нужен shortlist из каталога или честный практичный fallback",
              "passed": true,
              "reason": "At least one sub-check passed",
              "details": {
                "sub": [
                  {
                    "type": "company_path_min_count",
                    "passed": true,
                    "reason": "Enough /company links"
                  },
                  {
                    "type": "includes_any",
                    "passed": true,
                    "reason": "Matched at least one pattern"
                  }
                ]
              }
            }
          ]
        },
        {
          "turn": 2,
          "user": "Любую картошку. Где купить?",
          "requestBody": {
            "message": "Любую картошку. Где купить?",
            "history": [
              {
                "role": "user",
                "content": "Где купить тонну картошки в витебске?"
              },
              {
                "role": "assistant",
                "content": "Подходящие варианты (из доступного списка):\n\n1. **Беккер Бис ООО** — посадочный материал/рассада; Витебск. Может быть полезно, если нужен **посадочный картофель**. /company/abekker\n\nЧтобы найти именно **продовольственный картофель оптом** (1 тонна), рекомендую в рубрикаторе искать:\n- **Рубрики:** Овощи оптом; Сельхозпродукция оптом; Продукты питания оптом; Картофель (если есть отдельная рубрика)\n- **Ключевые слова:** картофель оптом, картошка оптом, овощи оптом, сельхозпродукция\n\nФильтры: **Витебск** и/или **Витебская область** (если готовы расширить ради предложения и цены).\n\nУточните, пожалуйста:\n1) Вам нужен **продовольственный** или **посадочный** картофель?  \n2) Нужна **доставка** по Витебску или самовывоз?  \n3) Какие **сроки** и **требования к качеству/сорту**?"
              }
            ]
          },
          "latencyMs": 5376,
          "apiOk": true,
          "status": 200,
          "retryMeta": {
            "quota": 0,
            "busy": 0,
            "rateLimited": 0,
            "stub": 0
          },
          "requestId": "2b0b6ba4-e9ab-41c1-9a73-da7584973e2b",
          "isStub": false,
          "reply": "Вот доступный вариант из списка:\n\n1. **Беккер Бис ООО** — посадочный материал/рассада; Витебск. Подходит, если нужна **посадочная картошка**. /company/abekker\n\nЧтобы найти продавцов **продовольственного картофеля оптом** в Витебске, попробуйте в рубрикаторе:\n- **Рубрики:** Овощи оптом; Сельхозпродукция оптом; Продукты питания оптом  \n- **Ключевые слова:** картофель оптом, картошка оптом, овощи оптом\n\nФильтр: **Витебск** (можно расширить до Витебской области для большего выбора).\n\nУточните, пожалуйста:\n1) Нужна **продовольственная** или **посадочная** картошка?  \n2) Нужна **доставка** или самовывоз?  \n3) Ориентировочный **объем**?",
          "checks": [
            {
              "id": "R002.T2.C1",
              "type": "not_stub",
              "description": "Ответ не должен быть stub",
              "passed": true,
              "reason": "Reply is non-stub",
              "details": {
                "isStub": false
              }
            },
            {
              "id": "R002.T2.C2",
              "type": "includes_any",
              "description": "Должно сохраняться гео-уточнение из истории",
              "passed": true,
              "reason": "Matched at least one pattern",
              "details": {
                "patterns": [
                  "витеб",
                  "локаци"
                ],
                "hits": [
                  "витеб"
                ]
              }
            },
            {
              "id": "R002.T2.C3",
              "type": "excludes_all",
              "description": "Не показывать явно нерелевантные компании как candidates",
              "passed": true,
              "reason": "No forbidden patterns found",
              "details": {
                "patterns": [
                  "не по теме",
                  "автолайт",
                  "жалюзи",
                  "электрооборуд"
                ],
                "hits": []
              }
            }
          ]
        }
      ],
      "durationMs": 11281
    },
    {
      "id": "R003",
      "title": "Молоко в Витебске: не подставлять нерелевантные компании",
      "tags": [
        "regression",
        "geo",
        "sourcing",
        "relevance"
      ],
      "personaGoal": "Закупщик ищет молоко оптом в Витебске и не хочет видеть нерелевантные компании в first-pass",
      "totalTurns": 1,
      "completedTurns": 1,
      "pass": true,
      "hardError": null,
      "failedChecks": [],
      "turns": [
        {
          "turn": 1,
          "user": "Где можно купить тонну молока в Витебске?",
          "requestBody": {
            "message": "Где можно купить тонну молока в Витебске?",
            "history": []
          },
          "latencyMs": 7057,
          "apiOk": true,
          "status": 200,
          "retryMeta": {
            "quota": 0,
            "busy": 0,
            "rateLimited": 0,
            "stub": 0
          },
          "requestId": "05b87c16-ebdd-451c-9a94-7e72426d8e4e",
          "isStub": false,
          "reply": "Вот ближайшие совпадения из доступного списка (в Витебске), хотя это **не прямые поставщики молока** — скорее сопутствующие услуги:\n\n1. **МолХолСервис ООО** — монтаж и обслуживание молочного оборудования, охлаждение молока в полевых условиях. Подходит, если нужен технологический партнер/оснащение. /company/molholservis  \n2. **Витебскоблагропромтранс ОАО** — рефрижераторные и грузовые перевозки. Подходит для доставки молока. /company/vitoblapt  \n\nЧтобы найти **поставщиков молока (1 тонна)** в Витебске, рекомендую поиск по рубрикам и словам:\n- Рубрики: *Молочная продукция*, *Пищевые товары оптом*, *Фермерские хозяйства*, *Сельхозпредприятия*.\n- Ключевые слова: **«молоко оптом», «молоко сырье», «молочная продукция», «фермерское молоко», «закупка молока», «переработка молока»**.\n- Фильтры: регион **Витебская область**, город **Витебск**.\n\nУточните, пожалуйста:\n1) Нужно **сырье (молоко-сырец)** или **пастеризованное/фасованное**?  \n2) Разовая покупка или **регулярные поставки**?  \n3) Нужна ли **доставка** и в какие сроки?",
          "checks": [
            {
              "id": "R003.T1.C1",
              "type": "not_stub",
              "description": "Ответ не должен быть stub",
              "passed": true,
              "reason": "Reply is non-stub",
              "details": {
                "isStub": false
              }
            },
            {
              "id": "R003.T1.C2",
              "type": "includes_any",
              "description": "Должна учитываться локация Витебск",
              "passed": true,
              "reason": "Matched at least one pattern",
              "details": {
                "patterns": [
                  "витеб",
                  "vitebsk"
                ],
                "hits": [
                  "витеб"
                ]
              }
            },
            {
              "id": "R003.T1.C3",
              "type": "excludes_all",
              "description": "Не показывать явно нерелевантные категории как кандидатов",
              "passed": true,
              "reason": "No forbidden patterns found",
              "details": {
                "patterns": [
                  "электротех",
                  "стекл",
                  "мебел",
                  "центр[ы]?\\s+занятост"
                ],
                "hits": []
              }
            }
          ]
        }
      ],
      "durationMs": 7057
    }
  ]
}
