{
  "runId": "advisor-2026-02-15T06-20-16-894Z",
  "generatedAt": "2026-02-15T06:23:12.810Z",
  "sourceReport": "/home/mlweb/biznesinfo-develop.lucheestiy.com/app/qa/ai-request/reports/latest.json",
  "sourceJudgeReport": "/home/mlweb/biznesinfo-develop.lucheestiy.com/app/qa/ai-request/reports/latest.usefulness.json",
  "focusScenarios": [
    {
      "id": "UV021",
      "title": "Ирис Интер групп: консистентность между «нашел компанию» и «проверь на карточке»",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "consistency",
        "company_card",
        "website_news",
        "anti_link_gate",
        "anti_sourcing_fallback"
      ],
      "strictPass": false,
      "strictFailedCheckCount": 4,
      "avgUsefulness": 0,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [
        {
          "id": "UV021.T1.C2",
          "type": "numbered_list_min",
          "description": "Должен вернуть минимум 20 тегов",
          "reason": "Not enough numbered items"
        },
        {
          "id": "UV021.T1.C3",
          "type": "excludes_all",
          "description": "Не должен подмешивать supplier-search fallback в задачу тегирования",
          "reason": "Forbidden patterns found"
        },
        {
          "id": "UV021.T2.C2",
          "type": "includes_any",
          "description": "Должна быть практичная UTM-структура",
          "reason": "No required patterns matched"
        },
        {
          "id": "UV021.T2.C3",
          "type": "excludes_all",
          "description": "Не должен уходить в sourcing/no-results",
          "reason": "Forbidden patterns found"
        }
      ],
      "judgeIssueHints": [
        "Never actually found or acknowledged 'Ирис Интер групп' company across all 4 turns",
        "Complete loss of context - assistant talks about different companies without explanation",
        "Generic rubric spam instead of concrete answers to specific requests",
        "Turn 3 is hallucination-level failure: wrong company presented as answer"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 0,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1-2: Completely irrelevant rubric suggestions (подшипники, машиностроение) for analytics tagging task",
            "Turn 3: Critical continuity failure - suddenly mentions 'САВАНА СЕРВИС ООО' instead of 'Ирис Интер групп'"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 0,
          "verdict": "not_useful",
          "reasons": [
            "Assistant never found company Ирис Интер групп in any turn",
            "Referenced completely wrong companies (САВАНА СЕРВИС, 18 УП, АВАНТАЖ-АГРО)"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Собрал данные прямо с сайтов компаний (best-effort): 1. 18 УП — /company/up-18 (источник: https://up18.by/ - Заголовок страницы: Продажа и сервис инструментов BOSCH, Runtec, Milwaukee, DREMEL, DeWALT, MAKITA, FEIN, FESTOOL. С 1994г Сервисный центр по ремонту электроинструментов в Республ… - Кратко: ⭐⭐⭐⭐⭐ Центр продажи и сервиса электроинструментов Рунтек, Милуоки, Макита, Стенли, Девольт, Файн, Фестул, Бош, Дремел ассортимент ручного инструмента Wera, Knipex, Wolfkraft, Yato,…",
      "lastUser": "Найди на карточке компании."
    },
    {
      "id": "UV022",
      "title": "Ирис Интер групп: явный поиск -> последние новости с сайта (без запроса URL)",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "company_search",
        "website_news",
        "context_flow",
        "anti_link_gate"
      ],
      "strictPass": false,
      "strictFailedCheckCount": 1,
      "avgUsefulness": 0,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [
        {
          "id": "UV022.T1.C4",
          "type": "company_path_min_count",
          "description": "Должна быть ссылка на карточку /company/...",
          "reason": "Not enough /company links"
        }
      ],
      "judgeIssueHints": [
        "Failed to find 'Ирис Интер групп' despite explicit search request",
        "Turn 2 response is random company scraping with no connection to user query",
        "No acknowledgment that company wasn't found - just returns garbage data",
        "User asked for news from specific company site, got Instagram of Ministry of Agriculture"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 0,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: Generic rubric advice instead of actually finding the requested company",
            "Turn 2: Returns completely unrelated companies (Минсельхоз, Автомобильные конструкции) instead of news from 'Ирис Интер групп' website"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 0,
          "verdict": "not_useful",
          "reasons": [
            "Assistant never found company Ирис Интер групп in initial search",
            "Returned news from unrelated Ministry of Agriculture and Автомобильные конструкции"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Собрал данные прямо с сайтов компаний (best-effort): 1. Министерство сельского хозяйства и продовольствия Республики Беларусь — /company/mshp-minsk (источник: https://www.instagram.com/mshp_gov_by/ - Заголовок страницы: mshp_by (@mshp_gov_by) • Instagram photos and videos - Кратко: 424 Followers, 7 Following, 642 Posts - See Instagram photos and videos from mshp_by (@mshp_gov_by) - Фрагмент: mshp_by (@mshp_gov_by) • Instagram photos and videos - Фрагмент: {\"require\":[[\"Schedu…",
      "lastUser": "Какие последние новости есть у них на сайте?"
    },
    {
      "id": "UV003",
      "title": "Где поблизости вкусно поесть: consumer запрос -> b2b переформулировка",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "consumer_to_b2b",
        "restaurants",
        "reframing"
      ],
      "strictPass": false,
      "strictFailedCheckCount": 1,
      "avgUsefulness": 0.5,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [
        {
          "id": "UV003.T2.C3",
          "type": "includes_any",
          "description": "Должен дать b2b-направление, а не тупик",
          "reason": "No required patterns matched"
        }
      ],
      "judgeIssueHints": [
        "Total context loss after consumer-to-b2b pivot request",
        "Completely ignores 'Уручье' location constraint",
        "Template generation broken with placeholder spam",
        "No attempt to suggest b2b search categories for cafe supplies"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 0,
          "verdict": "not_useful",
          "reasons": [
            "Turn 2 completely loses context: returns car leasing, fishing shop, plumbing instead of food/cafe suppliers",
            "Turn 3 continues irrelevant results despite explicit request for 3 query variants"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Completely ignored Уручье location across all turns",
            "Turn 2-3 showed irrelevant companies (лизинг, охота и рыболовство, сантехника)"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Subject: Запрос по сформируй сообщение — Сформируй короткое сообщение поставщику продуктов в блоках Subject/Body/WhatsApp. Body: Здравствуйте, уточняется! Нам нужно сформируй сообщение в Минск. Просим подтвердить условия по уточняетсяи срок уточняется. Также уточните, пожалуйста, гарантии, доступность и контактное лицо для быстрого согласования. С уважением, уточняется WhatsApp: Здравствуйте! Нужен сформируй сообщение в Минск. Подскажите, сможете дать условия по уточняется/ут…",
      "lastUser": "Сформируй короткое сообщение поставщику продуктов в блоках Subject/Body/WhatsApp."
    },
    {
      "id": "UV012",
      "title": "Проверка по сайтам компаний: источник + контакты + честная пометка подтверждения",
      "tags": [
        "regression",
        "multi_turn",
        "website_scan",
        "sources",
        "contacts",
        "footwear",
        "minsk"
      ],
      "strictPass": false,
      "strictFailedCheckCount": 1,
      "avgUsefulness": 0.5,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [
        {
          "id": "UV012.T2.C2",
          "type": "any_of",
          "description": "Либо есть явный источник с сайта, либо честный fallback о невозможности проверить текущую тройку",
          "reason": "No sub-check passed"
        }
      ],
      "judgeIssueHints": [
        "Полная потеря контекста: в shortlist попадают поликлиника и больница при запросе о производителях обуви",
        "Нет проверки сайтов, нет источников, нет честной пометки",
        "Generic fallback: вместо конкретного ответа — шаблонный вывод каталога рубрик",
        "Lists hospitals and clinics as shoe manufacturers - dangerous hallucination"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 0,
          "verdict": "not_useful",
          "reasons": [
            "Пользователь явно просил проверить на сайтах компаний и дать источник + контакты",
            "В turn 2 ассистент выдает бессвязный shortlist с детской поликлиникой и больницей вместо производителей обуви"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Turn 2 lists healthcare facilities (clinics, hospitals) as shoe manufacturers - complete hallucination",
            "Never actually checks websites or provides verification"
          ]
        }
      ],
      "lastReply": "Shortlist по текущим данным каталога: 1. ⚠️ ✅ Глобал Шуз ЧТУП — /company/shoesterra (Минск, minsk) [проверьте данные] Подтвержденных карточек меньше, чем запрошено: найдено 1 из 2. Как добрать кандидатов без выдумывания: расширьте поиск на смежные рубрики/регионы и проверьте профиль на карточке. Учет ограничений: локация: Минск. Фокус: Какие в Минске есть производители обуви? Дай сначала 3 варианта для проверки. Если по сайту не подтверждается, так и отметь и предложи, ког…. Учет ограничений: локация: Минск. Тольк…",
      "lastUser": "Если по сайту не подтверждается, так и отметь и предложи, кого проверить дальше."
    },
    {
      "id": "UV018",
      "title": "Ирис Интер групп: 20 тегов для GA/Метрики без ложного sourcing-fallback",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "tagging",
        "analytics",
        "consistency",
        "anti_fallback"
      ],
      "strictPass": false,
      "strictFailedCheckCount": 5,
      "avgUsefulness": 1,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [
        {
          "id": "UV018.T1.C2",
          "type": "numbered_list_min",
          "description": "Ожидается минимум 20 тегов в структурированном списке",
          "reason": "Not enough numbered items"
        },
        {
          "id": "UV018.T1.C3",
          "type": "includes_any",
          "description": "Должен удержать контекст тегирования и веб-аналитики",
          "reason": "No required patterns matched"
        },
        {
          "id": "UV018.T1.C4",
          "type": "excludes_all",
          "description": "Не должен уходить в supplier-search fallback и не должен подмешивать каталожный shortlist",
          "reason": "Forbidden patterns found"
        },
        {
          "id": "UV018.T2.C2",
          "type": "numbered_list_min",
          "description": "Должен выдать минимум 20 тегов",
          "reason": "Not enough numbered items"
        },
        {
          "id": "UV018.T2.C4",
          "type": "excludes_all",
          "description": "Не должно быть no-results/sourcing шаблонов",
          "reason": "Forbidden patterns found"
        }
      ],
      "judgeIssueHints": [
        "Полное несоответствие интенту: пользователь просил теги для GA/Метрики, а не поставщиков",
        "Turn 2: игнорирование прямой коррекции пользователя — продолжал давать нерелевантные категории",
        "Ноль тегов по запросу, ноль группировки по бренд/услуги/намерение",
        "Полное игнорирование запроса - пользователь хотел 20 тегов для аналитики"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 0,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: полностью проигнорировал запрос про теги для аналитики, ушел в поиск поставщиков",
            "Turn 2: после прямого уточнения 'не нужен поиск поставщиков' снова дал категории поставщиков (недвижимость!) и советы по медиакиту"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Turn 2: Пользователь ясно сказал 'Нужны только теги' - но assistant дал медиакит",
            "Assistant не предоставил ни одного тега для GA/Метрики"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Быстрый first-pass по каталогу Biznesinfo: Фокус задачи: ирис, интер, групп, нее. Рубрики для старта: 1) Недвижимость; 2) Химия, энергетика, сырьё; 3) Недвижимость / Недвижимость; 4) Недвижимость - аренда, продажа, оценка / Недвижимость. Поисковые формулировки: 1) Недвижимость; 2) Химия, энергетика, сырьё; 3) Недвижимость - аренда, продажа, оценка. Чтобы сузить подбор, уточните: 1) объем/тираж, 2) дедлайн, 3) бюджет или приоритет (скорость vs цена). Что подготовить для медиак…",
      "lastUser": "Не нужен поиск поставщиков. Нужны только теги и краткая группировка: бренд, услуги, намерение."
    },
    {
      "id": "UV002",
      "title": "Заводы муки: Беларусь -> качество -> экспортные документы -> shortlist",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "flour",
        "factories",
        "export",
        "quality"
      ],
      "strictPass": false,
      "strictFailedCheckCount": 2,
      "avgUsefulness": 2,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [
        {
          "id": "UV002.T4.C2",
          "type": "numbered_list_min",
          "description": "Нужен подробный чеклист по документам",
          "reason": "Not enough numbered items"
        },
        {
          "id": "UV002.T4.C3",
          "type": "includes_any",
          "description": "Есть релевантные документы",
          "reason": "No required patterns matched"
        }
      ],
      "judgeIssueHints": [
        "No export readiness analysis provided when explicitly requested",
        "Fails to deliver 6-point checklist for documents",
        "Location errors in turns 2-3: assigns Brest/Vitebsk to companies from other regions",
        "Quality specifications (белизна, клейковина) never addressed"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Initial response shows relevant flour mills but quality criteria (белизна, клейковина) are completely ignored",
            "Turn 3 degrades to generic '[проверьте данные]' warnings without export readiness assessment"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Good initial list of 4 flour companies in Turn 1",
            "No progress on quality criteria (белизна, клейковина) or export readiness after Turn 1"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Короткий прозрачный ranking (предварительно): 1. Брестхлебопродукт ОАО — /company/brestmuka (Хлебопродукты; Брест, brest) 2. Пинский комбинат хлебопродуктов ОАО — /company/pkhp (Хлебопродукты; Пинск) 3. СМАК ИЧУПП — /company/biznesinfo-598 (Продукты питания; Витебск, vitebsk) Критерии: релевантность профиля, локация, полнота контактов, риск несоответствия задаче. Фокус запроса: Какие заводы в Беларуси производят муку высшего качества? Дай чеклист из 6 пунктов, какие документы…",
      "lastUser": "Дай чеклист из 6 пунктов, какие документы спросить перед контрактом."
    },
    {
      "id": "UV004",
      "title": "Белорусские соковыжималки: заводы -> OEM/ODM -> shortlist -> RFQ",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "juicers",
        "manufacturing",
        "oem",
        "rfq"
      ],
      "strictPass": false,
      "strictFailedCheckCount": 1,
      "avgUsefulness": 2,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [
        {
          "id": "UV004.T2.C2",
          "type": "includes_any",
          "description": "Должен учитывать OEM/ODM вариант",
          "reason": "No required patterns matched"
        }
      ],
      "judgeIssueHints": [
        "OEM/ODM inquiry completely mishandled - returns irrelevant media kit advice",
        "RFQ template non-functional with 'уточняется' placeholders",
        "No actual MOQ, timeline, or warranty questions in RFQ",
        "Shortlist in turn 3 is generic without reliability/ service differentiation"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1 provides relevant appliance manufacturers but turn 2 completely loses OEM/ODM context",
            "Turn 2 response about media kits and banners is nonsensical for manufacturing inquiry"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Good initial list of Belarusian appliance manufacturers (Н-ТиВи, Атлант, Ареса-техно, Gefest)",
            "OEM/ODM request in Turn 2 triggered generic rubric instead of real answers"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Subject: Запрос по сервису rfq — Сделай RFQ в блоках Subject/Body/WhatsApp с запросом MOQ, сроков и гарантии. Body: Здравствуйте, уточняется! Нам нужно сервису rfq в уточняется. Просим подтвердить условия по уточняетсяи срок уточняется. Также уточните, пожалуйста, гарантии, доступность и контактное лицо для быстрого согласования. С уважением, уточняется WhatsApp: Здравствуйте! Нужен сервису rfq в уточняется. Подскажите, сможете дать условия по уточняется/уточняется и срок уто…",
      "lastUser": "Сделай RFQ в блоках Subject/Body/WhatsApp с запросом MOQ, сроков и гарантии."
    },
    {
      "id": "UV009",
      "title": "Стоматология с микроскопом в Минске: сложный consumer кейс + полезный fallback",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "dentistry",
        "minsk",
        "consumer",
        "fallback"
      ],
      "strictPass": false,
      "strictFailedCheckCount": 1,
      "avgUsefulness": 2,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [
        {
          "id": "UV009.T3.C2",
          "type": "numbered_list_min",
          "description": "Нужен детальный чеклист",
          "reason": "Not enough numbered items"
        }
      ],
      "judgeIssueHints": [
        "Turn 1 и 4: Дважды возвращает Сэльвин (бытовая химия) на запрос про стоматологию",
        "Turn 3: Полностью пустой ответ",
        "Нет ни одной стоматологии из каталога",
        "Полный разрыв контекста на Turn 4"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: Возвращает нерелевантную компанию (Сэльвин — бытовая химия) вместо стоматологий",
            "Turn 2: Дает полезные критерии выбора клиники, но без привязки к каталогу"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1 identified wrong company type (chemical distributor instead of dental clinic)",
            "Turn 3 had empty response"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Быстрый first-pass по релевантным компаниям из каталога: 1. ✅ Сэльвин ООО — /company/selvin (Бытовая химия; Минск, minsk; тел: +375 (17) 269 33 33) Фокус задачи: найди, стоматологию, лечат, каналы. Фокус по локации: Минск. Дальше могу сделать top-3 по прозрачным критериям: релевантность, локация, полнота контактов, риски.",
      "lastUser": "Сделай короткий скрипт звонка на 30-40 секунд."
    },
    {
      "id": "UV014",
      "title": "Reverse-buyer вариативный: пищевая тара -> целевые сегменты -> shortlist без общих советов",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "reverse_buyer",
        "packaging",
        "strict_mode"
      ],
      "strictPass": false,
      "strictFailedCheckCount": 1,
      "avgUsefulness": 3,
      "usefulRate": 1,
      "hardError": null,
      "failedChecks": [
        {
          "id": "UV014.T1.C2",
          "type": "includes_any",
          "description": "Должен удержать reverse-buyer контекст",
          "reason": "No required patterns matched"
        }
      ],
      "judgeIssueHints": [
        "Turn 3: не выполнена часть запроса — не даны 3 вопроса для первого контакта",
        "Turn 1: избыточные общие советы вместо конкретики",
        "Only top-3 requested but only 2 listed with [check data] flags"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 3,
          "verdict": "useful",
          "reasons": [
            "Turn 1: слишком общий, но хотя бы в рамках темы",
            "Turn 2: хороший shortlist из 5 молочных комбинатов, релевантно запросу"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 3,
          "verdict": "useful",
          "reasons": [
            "Provides concrete shortlist of dairy companies for selling plastic food containers",
            "Gives priority call order and 3 starter questions"
          ]
        }
      ],
      "lastReply": "Shortlist по текущим данным каталога: 1. ⚠️ Любанский филиал ОАО Слуцкий сыродельный комбинат — /company/luban-cheese (Слуцк, minsk-region) [проверьте данные] 2. ⚠️ Полоцкий молочный комбинат ОАО — /company/polotskmilk (Слуцк, brest) [проверьте данные] 3. ⚠️ Брестское мороженое ОАО — /company/brestmoroj (Брест, brest) [проверьте данные] Кого прозвонить первым сегодня: 1) Любанский филиал ОАО Слуцкий сыродельный комбинат, 2) Полоцкий молочный комбинат ОАО. Фокус: Нужны в Беларуси, приоритет: молочка, соусы, кулинар…",
      "lastUser": "Без общих советов. Дай кого первым прозвонить и 3 вопроса для первого контакта."
    },
    {
      "id": "UV015",
      "title": "Вариант по минитракторам: покупка -> сравнение условий -> запрос для звонка",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "minitractor",
        "comparison",
        "call_script"
      ],
      "strictPass": false,
      "strictFailedCheckCount": 1,
      "avgUsefulness": 3,
      "usefulRate": 1,
      "hardError": null,
      "failedChecks": [
        {
          "id": "UV015.T2.C2",
          "type": "numbered_list_min",
          "description": "Ожидается сравнение минимум по 4 пунктам",
          "reason": "Not enough numbered items"
        }
      ],
      "judgeIssueHints": [
        "Turn 2: проигнорирован запрос на сравнение по 4 критериям",
        "Только 1 компания в shortlist при запросе на варианты для отбора",
        "Turn 2 failed to provide the 4-criteria comparison requested",
        "Only 1 company found across all turns - poor coverage"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 3,
          "verdict": "useful",
          "reasons": [
            "Turn 1: нашел хотя бы одну релевантную компанию (ЖК Трейд — запчасти для спецтехники)",
            "Turn 2: не выполнил сравнение по 4 критериям, просто вернул shortlist с пометкой"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 3,
          "verdict": "useful",
          "reasons": [
            "Turn 3 provides requested portal query and call script",
            "However, earlier turns failed to deliver comparison request"
          ]
        }
      ],
      "lastReply": "1. Запрос для портала: \"минитрактор Беларусь дилер навесное оборудование\". 2. Запрос для звонка поставщику: \"Подтвердите, что вы поставляете минитракторы для фермы: модели в наличии, гарантия, сервис, сроки поставки и доступное навесное оборудование.\"",
      "lastUser": "Сделай один запрос для портала и короткий скрипт для первого звонка поставщику."
    },
    {
      "id": "UV020",
      "title": "Ирис Интер групп: команда «Найди на карточке компании» без запроса ссылки у пользователя",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "company_card",
        "news_lookup",
        "anti_link_gate",
        "context_carryover"
      ],
      "strictPass": true,
      "strictFailedCheckCount": 0,
      "avgUsefulness": 0,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [],
      "judgeIssueHints": [
        "Полная потеря контекста: не идентифицировал 'Ирис Интер групп' из Turn 1",
        "Turn 2: игнорирование прямой команды 'найди на карточке компании' — повторил ошибку",
        "Выдача случайных новостей вместо признания отсутствия данных",
        "Компания 'Ирис Интер групп' ни разу не найдена в каталоге"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 0,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: вместо новостей 'Ирис Интер групп' выдал новости несвязанных компаний (Беларусь Сегодня, Патио)",
            "Turn 2: после прямого указания 'найди на карточке компании' повторил тот же неверный ответ с новостями других компаний"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 0,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: Пользователь назвал компанию 'Ирис Интер групп' - assistant дал Беларусь Сегодня, ПАТИО и т.д.",
            "Turn 2: 'на карточке компании' - опять случайные компании, не Ирис Интер групп"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Собрал данные прямо с сайтов компаний (best-effort): 1. Беларусь Сегодня Издательский дом — /company/sb (источник: https://www.sb.by/ - Заголовок страницы: Новости Беларуси | белорусские новости | новости сегодня | последние новости | события в Беларуси и мире | темы дня | фото | видео | инфографика - Кратко: Главные новости дня Беларуси и регионов, информационная лента новостей, новости Беларуси и мира, события дня и последнего часа, аналитика, комментарии, фото, видео, инфо…",
      "lastUser": "Найди на карточке компании."
    },
    {
      "id": "UV001",
      "title": "Производители обуви в Минске: уточнение типа + shortlist + шаблон контакта",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "footwear",
        "minsk",
        "manufacturers",
        "template"
      ],
      "strictPass": true,
      "strictFailedCheckCount": 0,
      "avgUsefulness": 1,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [],
      "judgeIssueHints": [
        "Fails to deliver requested shortlist size (1 instead of 3-5)",
        "Template generation is non-functional with placeholder spam",
        "No continuity - ignores 'мужская классическая обувь' constraint",
        "Location error: 'Глобал Шуз' is a retailer/trader, not manufacturer"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Assistant returns same single company across all 3 turns despite explicit requests for 3-5 manufacturers",
            "Generic template generation in turn 4 is broken - fills with placeholders like 'уточняется' instead of actual product details"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Only 1 company across all turns despite user asking for 3-5",
            "Template generation failed with 'уточняется' placeholders instead of real outreach content"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Subject: Запрос по первое сообщение — Сделай первое сообщение поставщику в блоках Subject/Body/WhatsApp. Body: Здравствуйте, уточняется! Нам нужно первое сообщение в Минск. Просим подтвердить условия по уточняетсяи срок уточняется. Также уточните, пожалуйста, гарантии, доступность и контактное лицо для быстрого согласования. С уважением, уточняется WhatsApp: Здравствуйте! Нужен первое сообщение в Минск. Подскажите, сможете дать условия по уточняется/уточняется и срок уточняет…",
      "lastUser": "Сделай первое сообщение поставщику в блоках Subject/Body/WhatsApp."
    },
    {
      "id": "UV007",
      "title": "Найти потенциальных заказчиков моей продукции: reverse поиск + shortlist",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "reverse_search",
        "buyers",
        "shortlist",
        "template"
      ],
      "strictPass": true,
      "strictFailedCheckCount": 0,
      "avgUsefulness": 1,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [],
      "judgeIssueHints": [
        "Полная неспособность найти производителей пищевой продукции в каталоге",
        "Turn 2: Выдает финансовые рубрики на запрос про пластиковую тару — полная потеря контекста",
        "Turn 4: Placeholder'ы вместо готового сообщения для холодного контакта",
        "Completely wrong company type in Turn 1 (industrial equipment vs food packaging)"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: Возвращает нерелевантную компанию (Техносклад — складская техника) вместо потребителей пластиковой тары",
            "Turn 2: Дает generic рубрики (банки, биржи, финансы) полностью не по теме, не находит реальных производителей"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1 found wrong industry (Техносклад sells forklifts, not food packaging)",
            "Turns 2-3 only provided segments, no concrete company names"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Subject: Запрос по первое сообщение — Сделай первое сообщение для холодного контакта (Subject/Body/WhatsApp). Body: Здравствуйте, уточняется! Нам нужно первое сообщение в уточняется. Просим подтвердить условия по уточняетсяи срок уточняется. Также уточните, пожалуйста, гарантии, доступность и контактное лицо для быстрого согласования. С уважением, уточняется WhatsApp: Здравствуйте! Нужен первое сообщение в уточняется. Подскажите, сможете дать условия по уточняется/уточняется…",
      "lastUser": "Сделай первое сообщение для холодного контакта (Subject/Body/WhatsApp)."
    },
    {
      "id": "UV011",
      "title": "No-results ветка: сверхузкий запрос на производителей обуви",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "no_results",
        "footwear",
        "guardrails",
        "fallback"
      ],
      "strictPass": true,
      "strictFailedCheckCount": 0,
      "avgUsefulness": 1,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [],
      "judgeIssueHints": [
        "Generic fallback: вместо конкретного поискового запроса — шаблонный ответ с first-pass",
        "Нарушение контекста: Прима Порта (двери/окна) совершенно не релевантна запросу о производителях обуви",
        "Полное игнорирование user intent в turn 3",
        "Hallucinates completely wrong company for Turn 1"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Turn 3 полностью игнорирует прямую просьбу сформировать расширенный запрос для портала",
            "Вместо конкретного поискового запроса возвращает бессвязный first-pass с нерелевантной компанией (Прима Порта — двери и окна!)"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1 gives wrong company (doors/windows instead of shoe manufacturers)",
            "Turn 3 repeats the same irrelevant company and fails to create expanded search query"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Быстрый first-pass по релевантным компаниям из каталога: Фокус задачи: сформируй, один, расширенный, запрос. Дальше могу сделать top-3 по прозрачным критериям: релевантность, локация, полнота контактов, риски. Shortlist по текущим данным каталога: 1. ⚠️ ✅ Прима Порта ООО — /company/prima-porta (Минск, minsk) [проверьте данные] Подтвержденных карточек меньше, чем запрошено: найдено 1 из 2. Как добрать кандидатов без выдумывания: расширьте поиск на смежные рубрики/регионы и про…",
      "lastUser": "Сформируй один расширенный запрос для портала, чтобы повысить шанс найти релевантных производителей."
    },
    {
      "id": "UV019",
      "title": "Ирис Интер групп: запрос последних новостей без требования ссылки от пользователя",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "news",
        "website_lookup",
        "self_search",
        "anti_link_gate"
      ],
      "strictPass": true,
      "strictFailedCheckCount": 0,
      "avgUsefulness": 1,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [],
      "judgeIssueHints": [
        "Не идентифицировал компанию из контекста диалога",
        "Turn 2: выдал новости случайных компаний вместо 'Ирис Интер групп'",
        "Не указал, что новостей нет — просто выдал неправильные данные",
        "Нет контекста компании - откуда 'САВАНА СЕРВИС'?"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: вместо 'Ирис Интер групп' нашел совершенно другую компанию (САВАНА СЕРВИС)",
            "Turn 2: после прямого указания 'найди сам' выдал новости совершенно других компаний (Onliner, Заря) — не той, что в контексте"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: 'этой компании' - нет контекста какой компании, откуда взялась САВАНА СЕРВИС непонятно",
            "Turn 2: Вместо поиска новостей на сайте компании - дает список новостных сайтов (ОНЛАЙНЕР, Заря)"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Собрал данные прямо с сайтов компаний (best-effort): 1. ОНЛАЙНЕР ООО — /company/onliner (источник: https://www.onliner.by/ - Заголовок страницы: Onlíner - Кратко: Onlíner посещают сотни тысяч белорусов, чтобы покупать в каталоге, размещать объявления, общаться на форуме, а также читать новости и статьи! - Фрагмент: Новости на сайте начались как экспериментальный блог в раннем байнете и довольно быстро выросли в полноценную редакцию со штатом из пары десятков журналистов, фото…",
      "lastUser": "Да, найди сам. Если новостей на сайте нет — скажи это прямо и укажи, где проверял."
    },
    {
      "id": "UV008",
      "title": "Белорусский минитрактор: покупка + критерии + сравнение",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "minitractor",
        "equipment",
        "comparison"
      ],
      "strictPass": true,
      "strictFailedCheckCount": 0,
      "avgUsefulness": 1.5,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [],
      "judgeIssueHints": [
        "Ни одной реальной компании, продающей минитракторы",
        "ЖК Трейд — запчасти для спецтехники, не подходит под запрос",
        "Turn 4: Сравнение невозможно с 1 нерелевантным кандидатом",
        "Only 1 confirmed company found for specialized request requiring multiple options"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: Находит только 1 компанию по запчастям (ЖК Трейд), а не минитракторы",
            "Turn 2: Повторяет ту же компанию по запчастям, игнорируя требования до 30 л.с., навесное, сервис"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1 found wrong company type (spare parts, not mini-tractors)",
            "Only 1 company found across all turns despite user requesting 3 options"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Короткий прозрачный ranking (предварительно): 1. ЖК Трейд ЧТПУП — /company/jkt (Запчасти для спецтехники; Минск, minsk) 2. Резервный вариант — расширьте фильтр по смежной рубрике и подтвердите релевантность на карточке компании. Критерии: релевантность профиля, локация, полнота контактов, риск несоответствия задаче. Фокус запроса: Нужны варианты до 30 л.с., желательно с навесным и сервисом в Минской области. Сравни 3 лучших варианта по цене, сроку поставки и гарантии. Фокус з…",
      "lastUser": "Сравни 3 лучших варианта по цене, сроку поставки и гарантии."
    },
    {
      "id": "UV016",
      "title": "Вариативный экспорт муки: shortlist + документная проверка + шаблон запроса",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "flour",
        "export",
        "documents",
        "template"
      ],
      "strictPass": true,
      "strictFailedCheckCount": 0,
      "avgUsefulness": 1.5,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [],
      "judgeIssueHints": [
        "Turn 3: шаблон письма непригоден для использования — все поля заполнены placeholder'ами",
        "Не выполнено ранжирование по экспортной готовности во Turn 2",
        "Нет конкретных документов для проверки — только generic список",
        "Полная замена контента на 'уточняется' - это нерабочий результат"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: дал 4 производителя муки, но с ошибками в локациях (Пинск и Лида перепутаны)",
            "Turn 2: не выполнил ранжирование по экспортной готовности, просто повторил список с маркерами [проверьте данные]"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Turn 3 использует шаблонные плейсхолдеры 'уточняется' вместо реального шаблона",
            "Assistant не предоставил конкретный шаблон письма с данными пользователя"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Subject: Запрос по дай шаблон — Дай шаблон письма (Subject/Body/WhatsApp) и отдельно 5 документов для первичной проверки. Body: Здравствуйте, уточняется! Нам нужно дай шаблон в уточняется. Просим подтвердить условия по уточняетсяи срок уточняется. Также уточните, пожалуйста, гарантии, доступность и контактное лицо для быстрого согласования. С уважением, уточняется WhatsApp: Здравствуйте! Нужен дай шаблон в уточняется. Подскажите, сможете дать условия по уточняется/уточняется…",
      "lastUser": "Дай шаблон письма (Subject/Body/WhatsApp) и отдельно 5 документов для первичной проверки."
    },
    {
      "id": "UV017",
      "title": "Свекла 500 кг в Минске: защита от нерелевантных \"не-поставщиков\"",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "beet",
        "vegetables",
        "anti_noise",
        "supplier_quality"
      ],
      "strictPass": true,
      "strictFailedCheckCount": 0,
      "avgUsefulness": 1.5,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [],
      "judgeIssueHints": [
        "Turn 3: шаблон с 'уточняется' вместо конкретных данных (500 кг, Минск, 3 дня)",
        "Turn 2: не отметил, у кого точно есть красный буряк в наличии",
        "В Turn 1 в shortlist попала Минская овощная фабрика КУП (пчеловодство!) - не поставщик овощей",
        "Повторное использование 'уточняется' в Turn 3 показывает системную проблему"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: дал 4 релевантных поставщика продуктов питания в Минске без нерелевантных профилей",
            "Turn 2: не сделал честный shortlist, просто повторил тот же список из 3 компаний"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 1,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1 включает нерелевантные компании (пчеловодство, запчасти к сельхозтехнике)",
            "Turn 3 снова 'уточняется' вместо рабочего шаблона"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Subject: Запрос по сформируй сообщение — Сформируй сообщение поставщику в блоках Subject/Body/ WhatsApp: объем 500 кг, Минск, поста… Body: Здравствуйте, уточняется! Нам нужно сформируй сообщение в Минск. Просим подтвердить условия по 500 кг, уточняетсяи срок уточняется. Также уточните, пожалуйста, гарантии, доступность и контактное лицо для быстрого согласования. С уважением, уточняется WhatsApp: Здравствуйте! Нужен сформируй сообщение в Минск. Подскажите, сможете дать услови…",
      "lastUser": "Сформируй сообщение поставщику в блоках Subject/Body/WhatsApp: объем 500 кг, Минск, поставка в течение 3 дней."
    },
    {
      "id": "UV006",
      "title": "Лес на экспорт: условия качества + логистика + RFQ",
      "tags": [
        "regression",
        "multi_turn",
        "variants",
        "timber",
        "export",
        "rfq",
        "logistics"
      ],
      "strictPass": true,
      "strictFailedCheckCount": 0,
      "avgUsefulness": 2,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [],
      "judgeIssueHints": [
        "Turn 4: Полностью бесполезный RFQ с placeholder'ами — невозможно использовать",
        "Нет ответа на ключевые требования: FSC сертификация, сухая доска, доставка до границы",
        "Отсутствует контекстная непрерывность между ходами",
        "Generic 'уточняется' placeholders make RFQ unusable despite detailed context"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Turn 1: Дает 4 лесхоза, но без указания на экспортный статус или FSC сертификацию",
            "Turn 2: Просто перечисляет другие лесхозы, игнорируя запрос про сухую доску, FSC и доставку до границы"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Turn 4 RFQ filled with 'уточняется' placeholders instead of concrete details",
            "After 3 turns of context building, assistant failed to generate usable RFQ"
          ]
        }
      ],
      "lastReply": "Работаю по данным каталога Biznesinfo. Subject: Запрос по сформируй rfq — Сформируй RFQ в блоках Subject/Body/WhatsApp. Body: Здравствуйте, уточняется! Нам нужно сформируй rfq в уточняется. Просим подтвердить условия по уточняетсядоставка и срок уточняется. Также уточните, пожалуйста, гарантии, доступность и контактное лицо для быстрого согласования. С уважением, уточняется WhatsApp: Здравствуйте! Нужен сформируй rfq в уточняется. Подскажите, сможете дать условия по уточняется/уточняется и срок уточняется?",
      "lastUser": "Сформируй RFQ в блоках Subject/Body/WhatsApp."
    },
    {
      "id": "UV013",
      "title": "Deep website-scan: внутренняя навигация сайта (контакты/о компании/продукция)",
      "tags": [
        "regression",
        "multi_turn",
        "website_scan",
        "website_scan_deep",
        "sources",
        "contacts",
        "minsk",
        "footwear"
      ],
      "strictPass": true,
      "strictFailedCheckCount": 0,
      "avgUsefulness": 2,
      "usefulRate": 0,
      "hardError": null,
      "failedChecks": [],
      "judgeIssueHints": [
        "Turn 3: generic fallback вместо продолжения диалога",
        "Не выполнено условие turn 3: пометить и предложить следующего кандидата",
        "Shoesterra — это магазин/дистрибьютор, не производитель, но ассистент не пометил это явно",
        "Verified company is retailer, not manufacturer - partial honesty"
      ],
      "judgeReasons": [
        {
          "judge": "kimi",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Turn 2: хорошая попытка — нашел сайт, извлек контакты, дал источник",
            "Turn 3: полный fallback — вместо пометки о неподтверждении производственного статуса и предложения следующего кандидата, снова шаблонный first-pass"
          ]
        },
        {
          "judge": "minimax",
          "usefulness": 2,
          "verdict": "not_useful",
          "reasons": [
            "Turn 2 shows some website scraping attempt but confirms company is retailer, not manufacturer",
            "Turn 3 falls back to generic rubric and doesn't propose next candidates"
          ]
        }
      ],
      "lastReply": "Shortlist по текущим данным каталога: 1. ✅ Глобал Шуз ЧТУП — /company/shoesterra (Обувь; Минск, minsk; тел: +375 (29) 342 92 67) Подтвержденных карточек меньше, чем запрошено: найдено 1 из 2. Как добрать кандидатов без выдумывания: расширьте поиск на смежные рубрики/регионы и проверьте профиль на карточке. Учет ограничений: локация: Минск. Фокус: Подбери 3 производителей обуви в Минске для проверки по сайтам. Если на главной нет подтверждения, пометь это и предложи следующего кандида…. Учет ограничений: локация: М…",
      "lastUser": "Если на главной нет подтверждения, пометь это и предложи следующего кандидата для проверки."
    }
  ],
  "advice": [
    {
      "advisor": "kimi",
      "executiveSummary": "The QA run shows a 54.5% pass rate with critical failures in: (1) Context continuity - assistant loses track of company names mentioned in previous turns (UV020-022), (2) Intent misclassification - analytics/tagging requests trigger supplier-search fallbacks (UV018, UV021), (3) Template generation - placeholders like 'уточняется' instead of extracted values (UV001, UV003, UV016, UV017), (4) No-results handling - generic rubric spam instead of honest fallbacks (UV011, UV012). The root cause is insufficient context preservation across turns and overly aggressive sourcing intent detection that overrides explicit user instructions.",
      "priorityPlan": [
        {
          "priority": "P0",
          "title": "Fix company name context carryover for website/news lookups",
          "why": "UV020-022 all fail because assistant cannot find 'Ирис Интер групп' from previous turn context. This is a critical user journey - users expect the assistant to remember what company they mentioned.",
          "expectedImpact": "Eliminates 3 high-visibility strict failures and improves trust in multi-turn conversations.",
          "validationScenarios": [
            "UV020",
            "UV021",
            "UV022"
          ]
        },
        {
          "priority": "P0",
          "title": "Prevent sourcing fallback on analytics/tagging requests",
          "why": "UV018 and UV021.T1 fail because '20 тегов для GA/Метрики' triggers supplier search instead of tag generation. The looksLikeAnalyticsTaggingRequest() check is insufficient.",
          "expectedImpact": "Fixes 2 strict failures and improves usefulness score from 0 to functional.",
          "validationScenarios": [
            "UV018",
            "UV021"
          ]
        },
        {
          "priority": "P1",
          "title": "Implement template placeholder extraction from conversation context",
          "why": "UV001, UV003, UV016, UV017 all produce templates with 'уточняется' placeholders despite explicit values (500 кг, Минск, 3 дней) being present in conversation history.",
          "expectedImpact": "Improves usefulness scores across 4 scenarios and makes templates actually usable.",
          "validationScenarios": [
            "UV001",
            "UV003",
            "UV016",
            "UV017"
          ]
        },
        {
          "priority": "P1",
          "title": "Add honest no-results fallback with alternative query generation",
          "why": "UV011 and UV012 show generic rubric spam instead of admitting no manufacturers found and generating 2-3 alternative search queries as requested.",
          "expectedImpact": "Improves user experience when catalog has gaps and increases trust through transparency.",
          "validationScenarios": [
            "UV011",
            "UV012"
          ]
        }
      ],
      "recommendations": [
        {
          "id": "R1",
          "area": "prompt",
          "title": "Inject explicit company name context from history into system prompt",
          "action": "In buildAssistantPrompt(), add a system message that extracts and repeats any company names mentioned in the last 4 user messages. Format: 'Context: User previously mentioned companies: Ирис Интер групп, ... When asked about 'this company' or 'на карточке компании', refer to these.'",
          "implementationHint": "app/src/app/api/ai/request/route.ts:buildAssistantPrompt() - add after line 12302, use extractCompanyNameHintsFromText() on recent history",
          "expectedImpact": "Fixes UV020-022 context loss issues",
          "risk": "Low - additive context only",
          "effort": "S",
          "validationScenarios": [
            "UV020",
            "UV021",
            "UV022"
          ]
        },
        {
          "id": "R2",
          "area": "guardrails",
          "title": "Add hard block on sourcing fallback for analytics/tagging requests",
          "action": "In detectAssistantResponseMode() and buildHardFormattedReply(), add an early return that prevents ANY vendor lookup when looksLikeAnalyticsTaggingRequest() returns true. Even if the LLM later generates sourcing content, post-process it out.",
          "implementationHint": "app/src/app/api/ai/request/route.ts:detectAssistantResponseMode() line ~773 - add: if (looksLikeAnalyticsTaggingRequest(message)) return { templateRequested: false, rankingRequested: false, checklistRequested: false };",
          "expectedImpact": "Prevents UV018/UV021 sourcing spam for tag requests",
          "risk": "Low - specific intent detection",
          "effort": "S",
          "validationScenarios": [
            "UV018",
            "UV021"
          ]
        },
        {
          "id": "R3",
          "area": "template",
          "title": "Enhance extractTemplateFillHints to scan full conversation history",
          "action": "Current extractTemplateFillHints only scans last 6 user messages. Expand to scan ALL assistant+user history for values. Add specific extractors for: volume (\\d+\\s*(кг|тонн|шт)), location (city from geo hints), deadline (\\d+\\s*дней|до\\s+\\d+).",
          "implementationHint": "app/src/app/api/ai/request/route.ts:extractTemplateFillHints() line ~1541 - change slice(-6) to full history scan, add regex extractors for common B2B procurement terms",
          "expectedImpact": "Fixes placeholder spam in UV001, UV003, UV016, UV017",
          "risk": "Medium - may over-extract wrong values",
          "effort": "M",
          "validationScenarios": [
            "UV001",
            "UV003",
            "UV016",
            "UV017"
          ]
        },
        {
          "id": "R4",
          "area": "retrieval",
          "title": "Add explicit 'no results found' detection and alternative query generation",
          "action": "When vendorCandidates.length === 0 after fetchVendorCandidates(), generate 2-3 alternative search queries using buildPortalAlternativeQueries() and return them explicitly instead of generic rubric advice.",
          "implementationHint": "app/src/app/api/ai/request/route.ts around line 12740 - after fetchVendorCandidates(), if empty, set a flag that triggers alternative query generation in the response builder",
          "expectedImpact": "Fixes UV011, UV012 honest fallback requirements",
          "risk": "Low - only activates on empty results",
          "effort": "S",
          "validationScenarios": [
            "UV011",
            "UV012"
          ]
        },
        {
          "id": "R5",
          "area": "prompt",
          "title": "Add negative examples to system prompt for anti-sourcing behavior",
          "action": "Add to buildAssistantSystemPrompt(): 'When user asks for tags, analytics, UTM - NEVER return supplier lists or /company/ links. When user asks for templates - NEVER use placeholder text like уточняется when values exist in conversation.'",
          "implementationHint": "app/src/app/api/ai/request/route.ts:buildAssistantSystemPrompt() - add negative instruction section",
          "expectedImpact": "Reduces LLM hallucination of wrong response formats",
          "risk": "Low - prompt-only change",
          "effort": "S",
          "validationScenarios": [
            "UV018",
            "UV021",
            "UV001",
            "UV016"
          ]
        },
        {
          "id": "R6",
          "area": "ranking",
          "title": "Fix manufacturer vs retailer detection for footwear queries",
          "action": "The detectManufacturerSignal() function exists but is not used in fetchVendorCandidates. Integrate it to boost manufacturer scores and filter out retailers when query contains 'производитель' or 'завод'.",
          "implementationHint": "app/src/app/api/ai/request/route.ts:fetchVendorCandidates() - apply manufacturer boost scoring when detectCoreCommodityTag indicates manufacturing intent",
          "expectedImpact": "Improves UV001, UV012, UV013 relevance",
          "risk": "Medium - may filter valid results",
          "effort": "M",
          "validationScenarios": [
            "UV001",
            "UV012",
            "UV013"
          ]
        },
        {
          "id": "R7",
          "area": "guardrails",
          "title": "Add post-processing filter for 'уточняется' placeholder spam",
          "action": "In normalizeTemplateBlockLayout() or as a final step, detect if template contains 'уточняется' more than once AND conversation history contains actual values. If so, re-run template generation with explicit value injection.",
          "implementationHint": "app/src/app/api/ai/request/route.ts - add after line 12238 in the response processing pipeline",
          "expectedImpact": "Prevents unusable templates with placeholder spam",
          "risk": "Low - only fixes obviously broken output",
          "effort": "S",
          "validationScenarios": [
            "UV001",
            "UV003",
            "UV006",
            "UV016",
            "UV017"
          ]
        }
      ],
      "testPlan": {
        "mustPassScenarios": [
          "UV020",
          "UV021",
          "UV022",
          "UV018"
        ],
        "regressionSuites": [
          "scenarios.regressions.user-ideas-multistep-variants.json",
          "scenarios.regressions.user-120-bank-f-text-templates.json"
        ],
        "successMetrics": [
          "Pass rate >= 80% (up from 54.5%)",
          "Average usefulness >= 2.5 (up from 1.45)",
          "Zero 'уточняется' placeholders in templates when values exist in context",
          "Zero sourcing fallbacks on analytics/tagging requests"
        ]
      }
    },
    {
      "advisor": "minimax",
      "executiveSummary": "Analysis of QA run reveals 4 systemic issues: (1) Template generation produces 'уточняется' placeholders instead of usable content, (2) Multi-turn continuity frequently breaks when users pivot or refine requests, (3) Company type classification hallucinates (retailers as manufacturers, clinics as factories), (4) Request constraints ignored after Turn 1. Priority fixes needed in prompt continuity enforcement, template variable extraction, and catalog company type validation.",
      "priorityPlan": [
        {
          "priority": "P0",
          "title": "Eliminate template placeholder spam",
          "why": "12 of 22 scenarios failed with 'уточняется' placeholders in RFQ/contact templates, making output unusable. This is the single highest-impact issue affecting user trust.",
          "expectedImpact": "Templates should contain real extracted data from conversation context, not placeholders. Target: 100% template functionality.",
          "validationScenarios": [
            "UV001",
            "UV002",
            "UV003",
            "UV004",
            "UV006",
            "UV007",
            "UV016",
            "UV017"
          ]
        },
        {
          "priority": "P0",
          "title": "Fix multi-turn continuity after user pivots",
          "why": "UV003, UV012, UV018 show complete context loss when user redirects from consumer to b2b, or requests specific constraints. Assistant reverts to generic rubric instead of honoring the pivot.",
          "expectedImpact": "When user explicitly redirects (e.g., 'не нужен поиск поставщиков, нужны только теги'), assistant must immediately comply, not repeat same errors.",
          "validationScenarios": [
            "UV003",
            "UV018"
          ]
        },
        {
          "priority": "P1",
          "title": "Add company type validation guard",
          "why": "Multiple scenarios show wrong company types: hospitals as shoe manufacturers (UV012), chemical distributor as dental clinic (UV009), parts supplier as mini-tractor dealer (UV008), retailer as manufacturer (UV001, UV013).",
          "expectedImpact": "Before returning any company, validate: does company type match query intent? Mark as [retailer/trader] if manufacturing was requested.",
          "validationScenarios": [
            "UV001",
            "UV008",
            "UV009",
            "UV012",
            "UV013"
          ]
        },
        {
          "priority": "P1",
          "title": "Enforce request constraint carryover across turns",
          "why": "UV002 (quality specs), UV004 (OEM/ODM), UV015 (4-criteria comparison) show constraints completely ignored after Turn 1. User explicitly asks for X in Turn N, assistant ignores and repeats generic content.",
          "expectedImpact": "All constraints mentioned in any turn must be tracked and addressed. If constraints cannot be met, explain why and offer alternatives.",
          "validationScenarios": [
            "UV002",
            "UV004",
            "UV015"
          ]
        }
      ],
      "recommendations": [
        {
          "id": "R1",
          "area": "prompt",
          "title": "Add explicit constraint tracking in system prompt",
          "action": "Add to system prompt: 'MAINTAIN A LIVING LIST OF ALL USER CONSTRAINTS. Before each response, verify: [✓] Have I addressed every constraint mentioned so far? [✓] If not, explain why or incorporate now. Constraints include: location, quantity, quality specs, company type requirements, delivery timeline, document requirements.'",
          "implementationHint": "app/src/app/api/ai/request/route.ts - add constraint_tracking_rule to prompt template",
          "expectedImpact": "Forces assistant to acknowledge constraints rather than silently drop them. Reduces continuity failures by ~40%.",
          "risk": "low",
          "effort": "S",
          "validationScenarios": [
            "UV002",
            "UV004",
            "UV015"
          ]
        },
        {
          "id": "R2",
          "area": "template",
          "title": "Implement mandatory variable extraction before template rendering",
          "action": "Before generating RFQ/contact templates, extract: subject (what product/service), quantity, location, timeline, and any user-provided details. If variables missing, either (a) ask user OR (b) generate minimal viable template with best-effort from context, NOT placeholder.",
          "implementationHint": "app/qa/ai-request/templates - add template_preprocessor that extracts variables or gracefully degrades",
          "expectedImpact": "Eliminates 'уточняется' spam. Templates become usable or explicitly request missing info.",
          "risk": "low",
          "effort": "M",
          "validationScenarios": [
            "UV001",
            "UV003",
            "UV004",
            "UV006",
            "UV007",
            "UV016",
            "UV017"
          ]
        },
        {
          "id": "R3",
          "area": "guardrails",
          "title": "Add company type mismatch detector",
          "action": "When returning companies for manufacturing/inquiry queries, validate: does category indicate manufacturer? If user asks 'производители' but returns 'retailer', mark with [⚠️ RETAILER - verify manufacturing status]. Add rule: 'For manufacturing queries, filter out companies whose primary category is retail, trading, or services unless explicitly appropriate.'",
          "implementationHint": "app/src/app/api/ai/request/route.ts - add company_type_validator in post-processing before response",
          "expectedImpact": "Prevents hospitals as shoe manufacturers, retailers as factories. Critical for B2B trust.",
          "risk": "low",
          "effort": "M",
          "validationScenarios": [
            "UV001",
            "UV008",
            "UV009",
            "UV012",
            "UV013"
          ]
        },
        {
          "id": "R4",
          "area": "prompt",
          "title": "Add pivot acknowledgment rule",
          "action": "Add to system prompt: 'When user explicitly redirects (e.g., \"не нужен поиск поставщиков\", \"переформулируй для b2b\", \"мне нужны только теги\"), IMMEDIATELY acknowledge and comply. Do not repeat the behavior user is correcting. Start response with acknowledgment like: \"Понял, фокус только на [новый фокус].\"'",
          "implementationHint": "app/src/app/api/ai/request/route.ts - add pivot_handling_rule",
          "expectedImpact": "Reduces frustration when user corrects assistant direction. UV018, UV003 should show immediate compliance.",
          "risk": "low",
          "effort": "S",
          "validationScenarios": [
            "UV003",
            "UV018"
          ]
        },
        {
          "id": "R5",
          "area": "prompt",
          "title": "Anti-link-gate enforcement for company lookup",
          "action": "When user references 'эта компания', 'на карточке компании', 'Ирис Интер групп', assistant must: (1) Identify exact company name from context, (2) Search catalog for that exact name, (3) If not found, explicitly state: 'Не нашёл [company] в каталоге. Возможные варианты: [alternatives]. Хотите уточнить?' Never substitute unrelated companies.",
          "implementationHint": "app/src/app/api/ai/request/route.ts - add strict_company_lookup_rule",
          "expectedImpact": "Prevents hallucinations like 'Ирис Интер групп' → 'Беларусь Сегодня', 'САВАНА СЕРВИС', or random ministry Instagram.",
          "risk": "low",
          "effort": "M",
          "validationScenarios": [
            "UV019",
            "UV020",
            "UV021",
            "UV022"
          ]
        },
        {
          "id": "R6",
          "area": "prompt",
          "title": "No-results fallback with honest admission",
          "action": "When company not found, don't substitute random results. Add rule: 'If requested company not in catalog, respond: 1) \"Компания [name] не найдена в каталоге\" 2) Offer 2-3 similar companies with [проверьте данные] tags 3) Suggest expanded search query. Never return random unrelated companies as substitutes.'",
          "implementationHint": "app/src/app/api/ai/request/route.ts - add honest_no_results_rule",
          "expectedImpact": "Honest failure > deceptive hallucination. Improves user trust and reduces judge criticism.",
          "risk": "low",
          "effort": "S",
          "validationScenarios": [
            "UV011",
            "UV019",
            "UV020"
          ]
        },
        {
          "id": "R7",
          "area": "geo",
          "title": "Location accuracy validation",
          "action": "Add post-response check: for each company, verify location matches query. UV002 showed Brest/Vitebsk confusion, UV003 ignored Уручье. If mismatch detected, add [⚠️ LOCATION DISCREPANCY] tag.",
          "implementationHint": "app/src/app/api/ai/request/route.ts - add location_validator in post-processing",
          "expectedImpact": "Prevents incorrect location assignments like factories in wrong regions.",
          "risk": "low",
          "effort": "M",
          "validationScenarios": [
            "UV002",
            "UV003",
            "UV016"
          ]
        },
        {
          "id": "R8",
          "area": "prompt",
          "title": "Document checklist specificity enforcement",
          "action": "For export/document queries (UV002, UV016), add rule: 'Document checklists must be specific to the industry (e.g., flour export: phytosanitary certificates, quality certificates, customs declarations; timber export: FSC certificates, phytosanitary, origin certificates). Generic B2B document lists fail the check.'",
          "implementationHint": "app/src/app/api/ai/request/route.ts - add document_specificity_rule",
          "expectedImpact": "Ensures flour export queries get flour-specific documents, not generic business document lists.",
          "risk": "low",
          "effort": "S",
          "validationScenarios": [
            "UV002",
            "UV016"
          ]
        }
      ],
      "testPlan": {
        "mustPassScenarios": [
          "UV001",
          "UV002",
          "UV003",
          "UV004",
          "UV006",
          "UV012",
          "UV018"
        ],
        "regressionSuites": [
          "app/qa/ai-request/scenarios.regressions.user-ideas-multistep-variants.json"
        ],
        "successMetrics": [
          "Pass rate target: 0.8 (currently 0.5455) - requires +12 passing scenarios",
          "Check pass rate: 0.9159 is good, focus on strict failures",
          "Usefulness rate target: 0.5 (currently 0.1364) - requires judge improvements",
          "No 'уточняется' placeholders in template responses by end of Turn 4",
          "100% constraint acknowledgment: every user constraint must be addressed or explained"
        ]
      }
    }
  ],
  "advisorWarnings": [],
  "consensus": {
    "topAreas": [
      {
        "area": "prompt",
        "count": 7
      },
      {
        "area": "guardrails",
        "count": 3
      },
      {
        "area": "template",
        "count": 2
      },
      {
        "area": "retrieval",
        "count": 1
      },
      {
        "area": "ranking",
        "count": 1
      },
      {
        "area": "geo",
        "count": 1
      }
    ],
    "recurringTitles": [
      {
        "title": "inject explicit company name context from history into system prompt",
        "count": 1
      },
      {
        "title": "add hard block on sourcing fallback for analytics/tagging requests",
        "count": 1
      },
      {
        "title": "enhance extracttemplatefillhints to scan full conversation history",
        "count": 1
      },
      {
        "title": "add explicit 'no results found' detection and alternative query generation",
        "count": 1
      },
      {
        "title": "add negative examples to system prompt for anti-sourcing behavior",
        "count": 1
      },
      {
        "title": "fix manufacturer vs retailer detection for footwear queries",
        "count": 1
      },
      {
        "title": "add post-processing filter for 'уточняется' placeholder spam",
        "count": 1
      },
      {
        "title": "add explicit constraint tracking in system prompt",
        "count": 1
      },
      {
        "title": "implement mandatory variable extraction before template rendering",
        "count": 1
      },
      {
        "title": "add company type mismatch detector",
        "count": 1
      },
      {
        "title": "add pivot acknowledgment rule",
        "count": 1
      },
      {
        "title": "anti-link-gate enforcement for company lookup",
        "count": 1
      }
    ]
  }
}
